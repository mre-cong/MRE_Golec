<!DOCTYPE html>
<!-- Generated by Cython 0.29.33 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: springs.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.33</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="springs.c">springs.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: cimport cython</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: from libc.math cimport sqrt</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: from libc.math cimport fabs</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: cimport libc.math</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: cimport numpy as np</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">006</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 6, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: cpdef void accumulate_spring_forces(float[:,::1] gpu_spring_force, double[:,::1] springs, float[:,::1] spring_force):</pre>
<pre class='cython code score-46 '>static PyObject *__pyx_pw_7springs_1accumulate_spring_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static void __pyx_f_7springs_accumulate_spring_forces(__Pyx_memviewslice __pyx_v_gpu_spring_force, __Pyx_memviewslice __pyx_v_springs, __Pyx_memviewslice __pyx_v_spring_force, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_i;
  int __pyx_v_node_idx_i;
  int __pyx_v_node_idx_j;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("accumulate_spring_forces", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

/* Python wrapper */
static PyObject *__pyx_pw_7springs_1accumulate_spring_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7springs_1accumulate_spring_forces(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_gpu_spring_force = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_springs = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_spring_force = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("accumulate_spring_forces (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_gpu_spring_force,&amp;__pyx_n_s_springs,&amp;__pyx_n_s_spring_force,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_gpu_spring_force)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_springs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accumulate_spring_forces", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_spring_force)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accumulate_spring_forces", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "accumulate_spring_forces") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_gpu_spring_force = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_float</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_gpu_spring_force.memview)) __PYX_ERR(0, 10, __pyx_L3_error)</span>
    __pyx_v_springs = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_springs.memview)) __PYX_ERR(0, 10, __pyx_L3_error)</span>
    __pyx_v_spring_force = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_float</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_spring_force.memview)) __PYX_ERR(0, 10, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("accumulate_spring_forces", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.accumulate_spring_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7springs_accumulate_spring_forces(__pyx_self, __pyx_v_gpu_spring_force, __pyx_v_springs, __pyx_v_spring_force);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7springs_accumulate_spring_forces(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_gpu_spring_force, __Pyx_memviewslice __pyx_v_springs, __Pyx_memviewslice __pyx_v_spring_force) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("accumulate_spring_forces", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_gpu_spring_force.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("gpu_spring_force"); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_springs.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("springs"); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_spring_force.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("spring_force"); <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span> }
  __pyx_t_1 = __Pyx_void_to_None(__pyx_f_7springs_accumulate_spring_forces(__pyx_v_gpu_spring_force, __pyx_v_springs, __pyx_v_spring_force, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.accumulate_spring_forces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_gpu_spring_force, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_springs, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_spring_force, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">011</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>:     cdef int node_idx_i</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>:     cdef int node_idx_j</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>:     for i in range(gpu_spring_force.shape[0]):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_gpu_spring_force.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">015</span>:         node_idx_i = int(springs[i,0])</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    __pyx_v_node_idx_i = ((int)(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_4 * __pyx_v_springs.strides[0]) )) + __pyx_t_5)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">016</span>:         node_idx_j = int(springs[i,1])</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_i;
    __pyx_t_4 = 1;
    __pyx_v_node_idx_j = ((int)(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_5 * __pyx_v_springs.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>:         spring_force[node_idx_i,0] += gpu_spring_force[i,0]</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 0;
    __pyx_t_6 = __pyx_v_node_idx_i;
    __pyx_t_7 = 0;
    *((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_spring_force.data + __pyx_t_6 * __pyx_v_spring_force.strides[0]) )) + __pyx_t_7)) )) += (*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_gpu_spring_force.data + __pyx_t_4 * __pyx_v_gpu_spring_force.strides[0]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">018</span>:         spring_force[node_idx_i,1] += gpu_spring_force[i,1]</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_i;
    __pyx_t_4 = 1;
    __pyx_t_7 = __pyx_v_node_idx_i;
    __pyx_t_6 = 1;
    *((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_spring_force.data + __pyx_t_7 * __pyx_v_spring_force.strides[0]) )) + __pyx_t_6)) )) += (*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_gpu_spring_force.data + __pyx_t_5 * __pyx_v_gpu_spring_force.strides[0]) )) + __pyx_t_4)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">019</span>:         spring_force[node_idx_i,2] += gpu_spring_force[i,2]</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 2;
    __pyx_t_6 = __pyx_v_node_idx_i;
    __pyx_t_7 = 2;
    *((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_spring_force.data + __pyx_t_6 * __pyx_v_spring_force.strides[0]) )) + __pyx_t_7)) )) += (*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_gpu_spring_force.data + __pyx_t_4 * __pyx_v_gpu_spring_force.strides[0]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>:         spring_force[node_idx_j,0] -= gpu_spring_force[i,0]</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_i;
    __pyx_t_4 = 0;
    __pyx_t_7 = __pyx_v_node_idx_j;
    __pyx_t_6 = 0;
    *((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_spring_force.data + __pyx_t_7 * __pyx_v_spring_force.strides[0]) )) + __pyx_t_6)) )) -= (*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_gpu_spring_force.data + __pyx_t_5 * __pyx_v_gpu_spring_force.strides[0]) )) + __pyx_t_4)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">021</span>:         spring_force[node_idx_j,1] -= gpu_spring_force[i,1]</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_i;
    __pyx_t_5 = 1;
    __pyx_t_6 = __pyx_v_node_idx_j;
    __pyx_t_7 = 1;
    *((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_spring_force.data + __pyx_t_6 * __pyx_v_spring_force.strides[0]) )) + __pyx_t_7)) )) -= (*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_gpu_spring_force.data + __pyx_t_4 * __pyx_v_gpu_spring_force.strides[0]) )) + __pyx_t_5)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>:         spring_force[node_idx_j,2] -= gpu_spring_force[i,2]</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_i;
    __pyx_t_4 = 2;
    __pyx_t_7 = __pyx_v_node_idx_j;
    __pyx_t_6 = 2;
    *((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_spring_force.data + __pyx_t_7 * __pyx_v_spring_force.strides[0]) )) + __pyx_t_6)) )) -= (*((float *) ( /* dim=1 */ ((char *) (((float *) ( /* dim=0 */ (__pyx_v_gpu_spring_force.data + __pyx_t_5 * __pyx_v_gpu_spring_force.strides[0]) )) + __pyx_t_4)) )));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">023</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: #alternative implementation. start with node 0, counting up elements until you hit N_el_x. with node 0 get the other node indices by a similar mechanism used for the spring variable setting, how many nodes per line, or per plane, to get the other 7 entries. keeping track of the counter index compared to the number of elements in each direction to avoid continuing when you've just finished a boundary element. should be significantly faster than generating the positions and then going backwards to the index, and i need the additional speed up. that being said, the current implementation is, for 100x100x10 elements, ~26 times faster than the pure python. but i can do better than that.</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">027</span>: cpdef np.ndarray[np.int32_t, ndim=2] get_elements_v2(double[:] dimensions, double cube_side_length):</pre>
<pre class='cython code score-58 '>static PyObject *__pyx_pw_7springs_3get_elements_v2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_7springs_get_elements_v2(__Pyx_memviewslice __pyx_v_dimensions, double __pyx_v_cube_side_length, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_N_el_x;
  int __pyx_v_N_el_y;
  int __pyx_v_N_el_z;
  int __pyx_v_N_el;
  PyArrayObject *__pyx_v_elements = 0;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_nodes_per_line;
  int __pyx_v_nodes_per_plane;
  int __pyx_v_counter;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_elements;
  __Pyx_Buffer __pyx_pybuffer_elements;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_elements_v2", 0);
  __pyx_pybuffer_elements.pybuffer.buf = NULL;
  __pyx_pybuffer_elements.refcount = 0;
  __pyx_pybuffernd_elements.data = NULL;
  __pyx_pybuffernd_elements.rcbuffer = &amp;__pyx_pybuffer_elements;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_elements_v2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_elements);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7springs_3get_elements_v2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7springs_3get_elements_v2(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_dimensions = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cube_side_length;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_elements_v2 (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_dimensions,&amp;__pyx_n_s_cube_side_length,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dimensions)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cube_side_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_elements_v2", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_elements_v2") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_dimensions = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dimensions.memview)) __PYX_ERR(0, 27, __pyx_L3_error)</span>
    __pyx_v_cube_side_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_cube_side_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_elements_v2", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_elements_v2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7springs_2get_elements_v2(__pyx_self, __pyx_v_dimensions, __pyx_v_cube_side_length);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7springs_2get_elements_v2(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_dimensions, double __pyx_v_cube_side_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_elements_v2", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dimensions.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dimensions"); <span class='error_goto'>__PYX_ERR(0, 27, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_7springs_get_elements_v2(__pyx_v_dimensions, __pyx_v_cube_side_length, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 27, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_elements_v2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dimensions, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">028</span>:     cdef int N_el_x = np.int32(round(dimensions[0]/cube_side_length))</pre>
<pre class='cython code score-41 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ (__pyx_v_dimensions.data + __pyx_t_4 * __pyx_v_dimensions.strides[0]) )));
  if (unlikely(__pyx_v_cube_side_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_5 / __pyx_v_cube_side_length));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_round, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 28, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N_el_x = __pyx_t_7;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">029</span>:     cdef int N_el_y = np.int32(round(dimensions[1]/cube_side_length))</pre>
<pre class='cython code score-41 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ (__pyx_v_dimensions.data + __pyx_t_4 * __pyx_v_dimensions.strides[0]) )));
  if (unlikely(__pyx_v_cube_side_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_5 / __pyx_v_cube_side_length));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_round, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 29, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N_el_y = __pyx_t_7;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">030</span>:     cdef int N_el_z = np.int32(round(dimensions[2]/cube_side_length))</pre>
<pre class='cython code score-41 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_4 = 2;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ (__pyx_v_dimensions.data + __pyx_t_4 * __pyx_v_dimensions.strides[0]) )));
  if (unlikely(__pyx_v_cube_side_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  }
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_5 / __pyx_v_cube_side_length));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_round, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 30, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N_el_z = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">031</span>:     cdef int N_el = N_el_x * N_el_y * N_el_z</pre>
<pre class='cython code score-0 '>  __pyx_v_N_el = ((__pyx_v_N_el_x * __pyx_v_N_el_y) * __pyx_v_N_el_z);
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>:     cdef np.ndarray[np.int32_t, ndim=2] elements = np.empty((N_el,8),dtype=np.int32)</pre>
<pre class='cython code score-44 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N_el);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_8);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 32, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_8);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_elements = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 32, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_elements.diminfo[0].strides = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_elements.diminfo[0].shape = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_elements.diminfo[1].strides = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_elements.diminfo[1].shape = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_elements = ((PyArrayObject *)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">033</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>:     cdef int j</pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>:     cdef int k</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">036</span>:     cdef int nodes_per_line = N_el_z + 1</pre>
<pre class='cython code score-0 '>  __pyx_v_nodes_per_line = (__pyx_v_N_el_z + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>:     cdef int nodes_per_plane = (N_el_x + 1)*(N_el_z + 1)</pre>
<pre class='cython code score-0 '>  __pyx_v_nodes_per_plane = ((__pyx_v_N_el_x + 1) * (__pyx_v_N_el_z + 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">038</span>:     cdef int counter = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_counter = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">039</span>:     for i in range(N_el_z):</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_N_el_z;
  __pyx_t_10 = __pyx_t_7;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">040</span>:         for j in range(N_el_y):</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_N_el_y;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>:             for k in range(N_el_x):</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_N_el_x;
      __pyx_t_16 = __pyx_t_15;
      for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
        __pyx_v_k = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:                 elements[counter,0] = k*nodes_per_line + j*nodes_per_plane + i</pre>
<pre class='cython code score-0 '>        __pyx_t_4 = __pyx_v_counter;
        __pyx_t_18 = 0;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[1].strides) = (((__pyx_v_k * __pyx_v_nodes_per_line) + (__pyx_v_j * __pyx_v_nodes_per_plane)) + __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:                 elements[counter,1] = k*nodes_per_line + j*nodes_per_plane + i + 1</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_counter;
        __pyx_t_4 = 1;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[1].strides) = ((((__pyx_v_k * __pyx_v_nodes_per_line) + (__pyx_v_j * __pyx_v_nodes_per_plane)) + __pyx_v_i) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:                 elements[counter,2] = (k+1)*nodes_per_line + j*nodes_per_plane + i</pre>
<pre class='cython code score-0 '>        __pyx_t_4 = __pyx_v_counter;
        __pyx_t_18 = 2;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[1].strides) = ((((__pyx_v_k + 1) * __pyx_v_nodes_per_line) + (__pyx_v_j * __pyx_v_nodes_per_plane)) + __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:                 elements[counter,3] = (k+1)*nodes_per_line + j*nodes_per_plane + i + 1</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_counter;
        __pyx_t_4 = 3;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[1].strides) = (((((__pyx_v_k + 1) * __pyx_v_nodes_per_line) + (__pyx_v_j * __pyx_v_nodes_per_plane)) + __pyx_v_i) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">046</span>:                 elements[counter,4] = k*nodes_per_line + (j+1)*nodes_per_plane + i</pre>
<pre class='cython code score-0 '>        __pyx_t_4 = __pyx_v_counter;
        __pyx_t_18 = 4;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[1].strides) = (((__pyx_v_k * __pyx_v_nodes_per_line) + ((__pyx_v_j + 1) * __pyx_v_nodes_per_plane)) + __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:                 elements[counter,5] = k*nodes_per_line + (j+1)*nodes_per_plane + i + 1</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_counter;
        __pyx_t_4 = 5;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[1].strides) = ((((__pyx_v_k * __pyx_v_nodes_per_line) + ((__pyx_v_j + 1) * __pyx_v_nodes_per_plane)) + __pyx_v_i) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:                 elements[counter,6] = (k+1)*nodes_per_line + (j+1)*nodes_per_plane + i</pre>
<pre class='cython code score-0 '>        __pyx_t_4 = __pyx_v_counter;
        __pyx_t_18 = 6;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[1].strides) = ((((__pyx_v_k + 1) * __pyx_v_nodes_per_line) + ((__pyx_v_j + 1) * __pyx_v_nodes_per_plane)) + __pyx_v_i);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:                 elements[counter,7] = (k+1)*nodes_per_line + (j+1)*nodes_per_plane + i + 1</pre>
<pre class='cython code score-0 '>        __pyx_t_18 = __pyx_v_counter;
        __pyx_t_4 = 7;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_elements.diminfo[0].strides, __pyx_t_4, __pyx_pybuffernd_elements.diminfo[1].strides) = (((((__pyx_v_k + 1) * __pyx_v_nodes_per_line) + ((__pyx_v_j + 1) * __pyx_v_nodes_per_plane)) + __pyx_v_i) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:                 counter += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_counter = (__pyx_v_counter + 1);
      }
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">051</span>:     return elements</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_elements));
  __pyx_r = ((PyArrayObject *)__pyx_v_elements);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">052</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-74" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">055</span>: cpdef np.ndarray[np.int32_t, ndim=2] get_elements(double[:,::1] node_posns, double[:] dimensions, double cube_side_length):</pre>
<pre class='cython code score-74 '>static PyObject *__pyx_pw_7springs_5get_elements(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_7springs_get_elements(CYTHON_UNUSED __Pyx_memviewslice __pyx_v_node_posns, __Pyx_memviewslice __pyx_v_dimensions, double __pyx_v_cube_side_length, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_N_el_x;
  int __pyx_v_N_el_y;
  int __pyx_v_N_el_z;
  int __pyx_v_N_el;
  PyArrayObject *__pyx_v_elements = 0;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  double __pyx_v_posns[8][3];
  PyArrayObject *__pyx_v_element = 0;
  int __pyx_v_counter;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_element;
  __Pyx_Buffer __pyx_pybuffer_element;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_elements;
  __Pyx_Buffer __pyx_pybuffer_elements;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_elements", 0);
  __pyx_pybuffer_elements.pybuffer.buf = NULL;
  __pyx_pybuffer_elements.refcount = 0;
  __pyx_pybuffernd_elements.data = NULL;
  __pyx_pybuffernd_elements.rcbuffer = &amp;__pyx_pybuffer_elements;
  __pyx_pybuffer_element.pybuffer.buf = NULL;
  __pyx_pybuffer_element.refcount = 0;
  __pyx_pybuffernd_element.data = NULL;
  __pyx_pybuffernd_element.rcbuffer = &amp;__pyx_pybuffer_element;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_t_20));
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_element.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_elements", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_element.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_elements);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_element);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7springs_5get_elements(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_7springs_4get_elements[] = "given the node/vertex positions, dimensions of the simulated volume, and volume element edge length, return an N_elements by 8 array where each row represents a single volume element and each column is the associated row index in node_posns of a vertex of the volume element";
static PyObject *__pyx_pw_7springs_5get_elements(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  __Pyx_memviewslice __pyx_v_node_posns = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dimensions = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_cube_side_length;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_elements (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_node_posns,&amp;__pyx_n_s_dimensions,&amp;__pyx_n_s_cube_side_length,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_node_posns)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dimensions)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_elements", 1, 3, 3, 1); <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_cube_side_length)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_elements", 1, 3, 3, 2); <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_elements") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_node_posns = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_node_posns.memview)) __PYX_ERR(0, 55, __pyx_L3_error)</span>
    __pyx_v_dimensions = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dimensions.memview)) __PYX_ERR(0, 55, __pyx_L3_error)</span>
    __pyx_v_cube_side_length = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[2]); if (unlikely((__pyx_v_cube_side_length == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_elements", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_elements", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_7springs_4get_elements(__pyx_self, __pyx_v_node_posns, __pyx_v_dimensions, __pyx_v_cube_side_length);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7springs_4get_elements(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_node_posns, __Pyx_memviewslice __pyx_v_dimensions, double __pyx_v_cube_side_length) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_elements", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_node_posns.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("node_posns"); <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dimensions.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dimensions"); <span class='error_goto'>__PYX_ERR(0, 55, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_7springs_get_elements(__pyx_v_node_posns, __pyx_v_dimensions, __pyx_v_cube_side_length, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_elements", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_node_posns, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dimensions, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">056</span>:     """given the node/vertex positions, dimensions of the simulated volume, and volume element edge length, return an N_elements by 8 array where each row represents a single volume element and each column is the associated row index in node_posns of a vertex of the volume element"""</pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>:     #need to keep track of which nodes belong to a unit cell (at some point)</pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>:     #TODO move this part outside of the cdef function... and call a cdef function that returns void but sets the elements variable</pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:     cdef int N_el_x = np.int32(round(dimensions[0]/cube_side_length))</pre>
<pre class='cython code score-41 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ (__pyx_v_dimensions.data + __pyx_t_4 * __pyx_v_dimensions.strides[0]) )));
  if (unlikely(__pyx_v_cube_side_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
  }
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_5 / __pyx_v_cube_side_length));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_round, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N_el_x = __pyx_t_7;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     cdef int N_el_y = np.int32(round(dimensions[1]/cube_side_length))</pre>
<pre class='cython code score-41 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = 1;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ (__pyx_v_dimensions.data + __pyx_t_4 * __pyx_v_dimensions.strides[0]) )));
  if (unlikely(__pyx_v_cube_side_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_5 / __pyx_v_cube_side_length));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_round, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_6, __pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N_el_y = __pyx_t_7;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     cdef int N_el_z = np.int32(round(dimensions[2]/cube_side_length))</pre>
<pre class='cython code score-41 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_4 = 2;
  __pyx_t_5 = (*((double *) ( /* dim=0 */ (__pyx_v_dimensions.data + __pyx_t_4 * __pyx_v_dimensions.strides[0]) )));
  if (unlikely(__pyx_v_cube_side_length == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
  }
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_t_5 / __pyx_v_cube_side_length));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_builtin_round, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_6, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1); if (unlikely((__pyx_t_7 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_N_el_z = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:     cdef int N_el = N_el_x * N_el_y * N_el_z</pre>
<pre class='cython code score-0 '>  __pyx_v_N_el = ((__pyx_v_N_el_x * __pyx_v_N_el_y) * __pyx_v_N_el_z);
</pre><pre class="cython line score-0">&#xA0;<span class="">063</span>:     #finding the indices for the nodes/vertices belonging to each element</pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>:     #!!! need to check if there is any ordering to the vertices right now that I can use. I need to have each vertex for each element assigned an identity relative to the element for calculating average edge vectors to estimate the volume after deformation</pre>
<pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>:     cdef np.ndarray[np.int32_t, ndim=2] elements = np.empty((N_el,8),dtype=np.int32)</pre>
<pre class='cython code score-44 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_N_el);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_int_8);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 65, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_8) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_8, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_8);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_elements = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_elements.diminfo[0].strides = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_elements.diminfo[0].shape = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_elements.diminfo[1].strides = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_elements.diminfo[1].shape = __pyx_pybuffernd_elements.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_elements = ((PyArrayObject *)__pyx_t_8);
  __pyx_t_8 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">066</span>:     cdef int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:     cdef int j</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>:     cdef int k</pre>
<pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:     cdef double[8][3] posns = np.empty((8,3),dtype=np.float64)</pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_8, __pyx_int_3);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_8, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__2, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (unlikely(__Pyx_carray_from_py_double___5b_3_5d_(__pyx_t_2, __pyx_t_10, 8) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  memcpy(&amp;(__pyx_v_posns[0]), __pyx_t_10, sizeof(__pyx_v_posns[0]) * (8));
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple_);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:     cdef np.ndarray[np.int32_t, ndim=1] element = np.empty((8,),dtype=np.int32)</pre>
<pre class='cython code score-37 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_8);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_tuple__4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 70, __pyx_L1_error)</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_element.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_element = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_element.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 70, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_element.diminfo[0].strides = __pyx_pybuffernd_element.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_element.diminfo[0].shape = __pyx_pybuffernd_element.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_element = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__3);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 70, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">071</span>:     cdef int counter = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_counter = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>:     for i in range(N_el_z):</pre>
<pre class='cython code score-0 '>  __pyx_t_7 = __pyx_v_N_el_z;
  __pyx_t_12 = __pyx_t_7;
  for (__pyx_t_13 = 0; __pyx_t_13 &lt; __pyx_t_12; __pyx_t_13+=1) {
    __pyx_v_i = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:         for j in range(N_el_y):</pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_N_el_y;
    __pyx_t_15 = __pyx_t_14;
    for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
      __pyx_v_j = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:             for k in range(N_el_x):</pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_N_el_x;
      __pyx_t_18 = __pyx_t_17;
      for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
        __pyx_v_k = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:                 posns[0][0] = k*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[0])[0]) = (__pyx_v_k * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>:                 posns[0][1] = j*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[0])[1]) = (__pyx_v_j * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:                 posns[0][2] = i*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[0])[2]) = (__pyx_v_i * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:                 posns[1][0] = k*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[1])[0]) = (__pyx_v_k * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">079</span>:                 posns[1][1] = j*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[1])[1]) = (__pyx_v_j * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:                 posns[1][2] = (i+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[1])[2]) = ((__pyx_v_i + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:                 posns[2][0] = (k+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[2])[0]) = ((__pyx_v_k + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:                 posns[2][1] = j*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[2])[1]) = (__pyx_v_j * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:                 posns[2][2] = i*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[2])[2]) = (__pyx_v_i * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>:                 posns[3][0] = (k+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[3])[0]) = ((__pyx_v_k + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:                 posns[3][1] = j*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[3])[1]) = (__pyx_v_j * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:                 posns[3][2] = (i+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[3])[2]) = ((__pyx_v_i + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:                 posns[4][0] = k*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[4])[0]) = (__pyx_v_k * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:                 posns[4][1] = (j+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[4])[1]) = ((__pyx_v_j + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:                 posns[4][2] = i*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[4])[2]) = (__pyx_v_i * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>:                 posns[5][0] = k*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[5])[0]) = (__pyx_v_k * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>:                 posns[5][1] = (j+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[5])[1]) = ((__pyx_v_j + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:                 posns[5][2] = (i+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[5])[2]) = ((__pyx_v_i + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>:                 posns[6][0] = (k+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[6])[0]) = ((__pyx_v_k + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>:                 posns[6][1] = (j+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[6])[1]) = ((__pyx_v_j + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:                 posns[6][2] = i*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[6])[2]) = (__pyx_v_i * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>:                 posns[7][0] = (k+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[7])[0]) = ((__pyx_v_k + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>:                 posns[7][1] = (j+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[7])[1]) = ((__pyx_v_j + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>:                 posns[7][2] = (i+1)*cube_side_length</pre>
<pre class='cython code score-0 '>        ((__pyx_v_posns[7])[2]) = ((__pyx_v_i + 1) * __pyx_v_cube_side_length);
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:                 element = get_row_indices(posns,cube_side_length,dimensions)</pre>
<pre class='cython code score-25 '>        __pyx_t_2 = __pyx_format_from_typeinfo(&amp;__Pyx_TypeInfo_double);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = Py_BuildValue((char*) "("  __PYX_BUILD_PY_SSIZE_T  __PYX_BUILD_PY_SSIZE_T  ")", ((Py_ssize_t)8), ((Py_ssize_t)3));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_20 = __pyx_array_new(__pyx_t_1, sizeof(double), <span class='py_macro_api'>PyBytes_AS_STRING</span>(__pyx_t_2), (char *) "c", (char *) __pyx_v_posns);
        if (unlikely(!__pyx_t_20)) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_20);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(((PyObject *)__pyx_t_20), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_t_20)); __pyx_t_20 = 0;
        __pyx_t_2 = ((PyObject *)__pyx_f_7springs_get_row_indices(__pyx_t_21, __pyx_v_cube_side_length, __pyx_v_dimensions));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __PYX_XDEC_MEMVIEW(&amp;__pyx_t_21, 1);
        __pyx_t_21.memview = NULL;
        __pyx_t_21.data = NULL;
        {
          __Pyx_BufFmt_StackElem __pyx_stack[1];
          <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_element.rcbuffer-&gt;pybuffer);
          __pyx_t_22 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_element.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_2), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
          if (unlikely(__pyx_t_22 &lt; 0)) {
            <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_23, &amp;__pyx_t_24, &amp;__pyx_t_25);
            if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_element.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_element, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
              Py_XDECREF(__pyx_t_23); Py_XDECREF(__pyx_t_24); Py_XDECREF(__pyx_t_25);
              <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
            } else {
              <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_23, __pyx_t_24, __pyx_t_25);
            }
            __pyx_t_23 = __pyx_t_24 = __pyx_t_25 = 0;
          }
          __pyx_pybuffernd_element.diminfo[0].strides = __pyx_pybuffernd_element.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_element.diminfo[0].shape = __pyx_pybuffernd_element.rcbuffer-&gt;pybuffer.shape[0];
          if (unlikely(__pyx_t_22 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
        }
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_element, ((PyArrayObject *)__pyx_t_2));
        __pyx_t_2 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>:                 elements[counter,:] = element</pre>
<pre class='cython code score-21 '>        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_counter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_slice__5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_slice__5);
        __pyx_t_2 = 0;
        if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_elements), __pyx_t_1, ((PyObject *)__pyx_v_element)) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:                 counter +=1</pre>
<pre class='cython code score-0 '>        __pyx_v_counter = (__pyx_v_counter + 1);
      }
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>:     return elements</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_elements));
  __pyx_r = ((PyArrayObject *)__pyx_v_elements);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">103</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>: cdef np.ndarray[np.int32_t, ndim=1] get_row_indices(double[:,:] node_posns, double l_e, double[:] dim):</pre>
<pre class='cython code score-16 '>static PyArrayObject *__pyx_f_7springs_get_row_indices(__Pyx_memviewslice __pyx_v_node_posns, double __pyx_v_l_e, __Pyx_memviewslice __pyx_v_dim) {
  double __pyx_v_Lx;
  double __pyx_v_Lz;
  double __pyx_v_inv_l_e;
  __pyx_t_5numpy_int32_t __pyx_v_nodes_per_col;
  __pyx_t_5numpy_int32_t __pyx_v_nodes_per_row;
  PyArrayObject *__pyx_v_row_index = 0;
  int __pyx_v_i;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_row_index;
  __Pyx_Buffer __pyx_pybuffer_row_index;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_row_indices", 0);
  __pyx_pybuffer_row_index.pybuffer.buf = NULL;
  __pyx_pybuffer_row_index.refcount = 0;
  __pyx_pybuffernd_row_index.data = NULL;
  __pyx_pybuffernd_row_index.rcbuffer = &amp;__pyx_pybuffer_row_index;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_row_indices", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_row_index);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">107</span>:     """Return the row indices corresponding to the node positions of interest given the simulation dimension parameters"""</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>:     cdef double Lx = dim[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0;
  __pyx_v_Lx = (*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:     cdef double Lz = dim[2]</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 2;
  __pyx_v_Lz = (*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_1 * __pyx_v_dim.strides[0]) )));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:     cdef double inv_l_e = 1/l_e</pre>
<pre class='cython code score-5 '>  if (unlikely(__pyx_v_l_e == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
  }
  __pyx_v_inv_l_e = (1.0 / __pyx_v_l_e);
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:     cdef np.int32_t nodes_per_col = np.round(Lz/l_e + 1).astype(np.int32)</pre>
<pre class='cython code score-59 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_round);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_v_l_e == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
  }
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_Lz / __pyx_v_l_e) + 1.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_3 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_6, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_2 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_3, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = __Pyx_PyInt_As_npy_int32(__pyx_t_2); if (unlikely((__pyx_t_7 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_nodes_per_col = __pyx_t_7;
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:     cdef np.int32_t nodes_per_row = np.round(Lx/l_e + 1).astype(np.int32)</pre>
<pre class='cython code score-59 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_round);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__pyx_v_l_e == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>
  }
  __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_v_Lx / __pyx_v_l_e) + 1.0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_6 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_5 = (__pyx_t_6) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_6, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_2 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_5, __pyx_t_4) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_7 = __Pyx_PyInt_As_npy_int32(__pyx_t_2); if (unlikely((__pyx_t_7 == ((npy_int32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 112, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_nodes_per_row = __pyx_t_7;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:     cdef np.ndarray[np.int32_t, ndim=1] row_index = np.empty((node_posns.shape[0],),dtype=np.int32)</pre>
<pre class='cython code score-45 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_node_posns.shape[0]));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_2, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_row_index = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_row_index.diminfo[0].strides = __pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_row_index.diminfo[0].shape = __pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_row_index = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">114</span>:     cdef int i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:     for i in range(node_posns.shape[0]):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = (__pyx_v_node_posns.shape[0]);
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:         row_index[i] =  int(((nodes_per_col * inv_l_e * node_posns[i,0]) + (nodes_per_col * nodes_per_row * inv_l_e *node_posns[i,1]) + inv_l_e *node_posns[i,2]))</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = __pyx_v_i;
    __pyx_t_12 = 0;
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = 1;
    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 2;
    __pyx_t_17 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_row_index.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_row_index.diminfo[0].strides) = ((__pyx_t_5numpy_int32_t)((((__pyx_v_nodes_per_col * __pyx_v_inv_l_e) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_node_posns.data + __pyx_t_1 * __pyx_v_node_posns.strides[0]) ) + __pyx_t_12 * __pyx_v_node_posns.strides[1]) )))) + (((__pyx_v_nodes_per_col * __pyx_v_nodes_per_row) * __pyx_v_inv_l_e) * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_node_posns.data + __pyx_t_13 * __pyx_v_node_posns.strides[0]) ) + __pyx_t_14 * __pyx_v_node_posns.strides[1]) ))))) + (__pyx_v_inv_l_e * (*((double *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_node_posns.data + __pyx_t_15 * __pyx_v_node_posns.strides[0]) ) + __pyx_t_16 * __pyx_v_node_posns.strides[1]) ))))));
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:     return row_index</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_row_index));
  __pyx_r = ((PyArrayObject *)__pyx_v_row_index);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">118</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: # cpdef np.ndarray[np.float64_t,ndim=2] get_springs(np.ndarray[np.int8_t,ndim=1] node_type,  int max_springs, double[:] k, double[:] dim, double l_e):</pre>
<pre class="cython line score-242" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>: cpdef int get_springs(np.ndarray[np.int8_t,ndim=1] node_type, double[:,::1] springs, int max_springs, double[:] k, double[:] dim, double l_e):</pre>
<pre class='cython code score-242 '>static PyObject *__pyx_pw_7springs_7get_springs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_f_7springs_get_springs(PyArrayObject *__pyx_v_node_type, __Pyx_memviewslice __pyx_v_springs, CYTHON_UNUSED int __pyx_v_max_springs, __Pyx_memviewslice __pyx_v_k, __Pyx_memviewslice __pyx_v_dim, double __pyx_v_l_e, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_i;
  PyArrayObject *__pyx_v_ABOVE = 0;
  PyArrayObject *__pyx_v_BELOW = 0;
  PyArrayObject *__pyx_v_LEFT = 0;
  PyArrayObject *__pyx_v_RIGHT = 0;
  PyArrayObject *__pyx_v_FRONT = 0;
  PyArrayObject *__pyx_v_BACK = 0;
  PyArrayObject *__pyx_v_LTOP = 0;
  PyArrayObject *__pyx_v_LBOT = 0;
  PyArrayObject *__pyx_v_LFRONT = 0;
  PyArrayObject *__pyx_v_LBACK = 0;
  PyArrayObject *__pyx_v_RTOP = 0;
  PyArrayObject *__pyx_v_RBOT = 0;
  PyArrayObject *__pyx_v_RFRONT = 0;
  PyArrayObject *__pyx_v_RBACK = 0;
  PyArrayObject *__pyx_v_TOPFRONT = 0;
  PyArrayObject *__pyx_v_TOPBACK = 0;
  PyArrayObject *__pyx_v_BOTFRONT = 0;
  PyArrayObject *__pyx_v_BOTBACK = 0;
  PyArrayObject *__pyx_v_LTOPFRONT = 0;
  PyArrayObject *__pyx_v_LTOPBACK = 0;
  PyArrayObject *__pyx_v_LBOTFRONT = 0;
  PyArrayObject *__pyx_v_LBOTBACK = 0;
  PyArrayObject *__pyx_v_RTOPFRONT = 0;
  PyArrayObject *__pyx_v_RTOPBACK = 0;
  PyArrayObject *__pyx_v_RBOTFRONT = 0;
  PyArrayObject *__pyx_v_RBOTBACK = 0;
  int __pyx_v_j;
  int __pyx_v_Nz;
  int __pyx_v_Nx;
  int __pyx_v_nodes_per_line;
  int __pyx_v_nodes_per_plane;
  double __pyx_v_face_spring_length;
  double __pyx_v_center_diagonal_length;
  int __pyx_v_spring_counter;
  int __pyx_v_adjacent_node_indices[13];
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ABOVE;
  __Pyx_Buffer __pyx_pybuffer_ABOVE;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_BACK;
  __Pyx_Buffer __pyx_pybuffer_BACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_BELOW;
  __Pyx_Buffer __pyx_pybuffer_BELOW;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_BOTBACK;
  __Pyx_Buffer __pyx_pybuffer_BOTBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_BOTFRONT;
  __Pyx_Buffer __pyx_pybuffer_BOTFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_FRONT;
  __Pyx_Buffer __pyx_pybuffer_FRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LBACK;
  __Pyx_Buffer __pyx_pybuffer_LBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LBOT;
  __Pyx_Buffer __pyx_pybuffer_LBOT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LBOTBACK;
  __Pyx_Buffer __pyx_pybuffer_LBOTBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LBOTFRONT;
  __Pyx_Buffer __pyx_pybuffer_LBOTFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LEFT;
  __Pyx_Buffer __pyx_pybuffer_LEFT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LFRONT;
  __Pyx_Buffer __pyx_pybuffer_LFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LTOP;
  __Pyx_Buffer __pyx_pybuffer_LTOP;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LTOPBACK;
  __Pyx_Buffer __pyx_pybuffer_LTOPBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_LTOPFRONT;
  __Pyx_Buffer __pyx_pybuffer_LTOPFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RBACK;
  __Pyx_Buffer __pyx_pybuffer_RBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RBOT;
  __Pyx_Buffer __pyx_pybuffer_RBOT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RBOTBACK;
  __Pyx_Buffer __pyx_pybuffer_RBOTBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RBOTFRONT;
  __Pyx_Buffer __pyx_pybuffer_RBOTFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RFRONT;
  __Pyx_Buffer __pyx_pybuffer_RFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RIGHT;
  __Pyx_Buffer __pyx_pybuffer_RIGHT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RTOP;
  __Pyx_Buffer __pyx_pybuffer_RTOP;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RTOPBACK;
  __Pyx_Buffer __pyx_pybuffer_RTOPBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_RTOPFRONT;
  __Pyx_Buffer __pyx_pybuffer_RTOPFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_TOPBACK;
  __Pyx_Buffer __pyx_pybuffer_TOPBACK;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_TOPFRONT;
  __Pyx_Buffer __pyx_pybuffer_TOPFRONT;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_node_type;
  __Pyx_Buffer __pyx_pybuffer_node_type;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_springs", 0);
  __pyx_pybuffer_ABOVE.pybuffer.buf = NULL;
  __pyx_pybuffer_ABOVE.refcount = 0;
  __pyx_pybuffernd_ABOVE.data = NULL;
  __pyx_pybuffernd_ABOVE.rcbuffer = &amp;__pyx_pybuffer_ABOVE;
  __pyx_pybuffer_BELOW.pybuffer.buf = NULL;
  __pyx_pybuffer_BELOW.refcount = 0;
  __pyx_pybuffernd_BELOW.data = NULL;
  __pyx_pybuffernd_BELOW.rcbuffer = &amp;__pyx_pybuffer_BELOW;
  __pyx_pybuffer_LEFT.pybuffer.buf = NULL;
  __pyx_pybuffer_LEFT.refcount = 0;
  __pyx_pybuffernd_LEFT.data = NULL;
  __pyx_pybuffernd_LEFT.rcbuffer = &amp;__pyx_pybuffer_LEFT;
  __pyx_pybuffer_RIGHT.pybuffer.buf = NULL;
  __pyx_pybuffer_RIGHT.refcount = 0;
  __pyx_pybuffernd_RIGHT.data = NULL;
  __pyx_pybuffernd_RIGHT.rcbuffer = &amp;__pyx_pybuffer_RIGHT;
  __pyx_pybuffer_FRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_FRONT.refcount = 0;
  __pyx_pybuffernd_FRONT.data = NULL;
  __pyx_pybuffernd_FRONT.rcbuffer = &amp;__pyx_pybuffer_FRONT;
  __pyx_pybuffer_BACK.pybuffer.buf = NULL;
  __pyx_pybuffer_BACK.refcount = 0;
  __pyx_pybuffernd_BACK.data = NULL;
  __pyx_pybuffernd_BACK.rcbuffer = &amp;__pyx_pybuffer_BACK;
  __pyx_pybuffer_LTOP.pybuffer.buf = NULL;
  __pyx_pybuffer_LTOP.refcount = 0;
  __pyx_pybuffernd_LTOP.data = NULL;
  __pyx_pybuffernd_LTOP.rcbuffer = &amp;__pyx_pybuffer_LTOP;
  __pyx_pybuffer_LBOT.pybuffer.buf = NULL;
  __pyx_pybuffer_LBOT.refcount = 0;
  __pyx_pybuffernd_LBOT.data = NULL;
  __pyx_pybuffernd_LBOT.rcbuffer = &amp;__pyx_pybuffer_LBOT;
  __pyx_pybuffer_LFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_LFRONT.refcount = 0;
  __pyx_pybuffernd_LFRONT.data = NULL;
  __pyx_pybuffernd_LFRONT.rcbuffer = &amp;__pyx_pybuffer_LFRONT;
  __pyx_pybuffer_LBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_LBACK.refcount = 0;
  __pyx_pybuffernd_LBACK.data = NULL;
  __pyx_pybuffernd_LBACK.rcbuffer = &amp;__pyx_pybuffer_LBACK;
  __pyx_pybuffer_RTOP.pybuffer.buf = NULL;
  __pyx_pybuffer_RTOP.refcount = 0;
  __pyx_pybuffernd_RTOP.data = NULL;
  __pyx_pybuffernd_RTOP.rcbuffer = &amp;__pyx_pybuffer_RTOP;
  __pyx_pybuffer_RBOT.pybuffer.buf = NULL;
  __pyx_pybuffer_RBOT.refcount = 0;
  __pyx_pybuffernd_RBOT.data = NULL;
  __pyx_pybuffernd_RBOT.rcbuffer = &amp;__pyx_pybuffer_RBOT;
  __pyx_pybuffer_RFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_RFRONT.refcount = 0;
  __pyx_pybuffernd_RFRONT.data = NULL;
  __pyx_pybuffernd_RFRONT.rcbuffer = &amp;__pyx_pybuffer_RFRONT;
  __pyx_pybuffer_RBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_RBACK.refcount = 0;
  __pyx_pybuffernd_RBACK.data = NULL;
  __pyx_pybuffernd_RBACK.rcbuffer = &amp;__pyx_pybuffer_RBACK;
  __pyx_pybuffer_TOPFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_TOPFRONT.refcount = 0;
  __pyx_pybuffernd_TOPFRONT.data = NULL;
  __pyx_pybuffernd_TOPFRONT.rcbuffer = &amp;__pyx_pybuffer_TOPFRONT;
  __pyx_pybuffer_TOPBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_TOPBACK.refcount = 0;
  __pyx_pybuffernd_TOPBACK.data = NULL;
  __pyx_pybuffernd_TOPBACK.rcbuffer = &amp;__pyx_pybuffer_TOPBACK;
  __pyx_pybuffer_BOTFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_BOTFRONT.refcount = 0;
  __pyx_pybuffernd_BOTFRONT.data = NULL;
  __pyx_pybuffernd_BOTFRONT.rcbuffer = &amp;__pyx_pybuffer_BOTFRONT;
  __pyx_pybuffer_BOTBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_BOTBACK.refcount = 0;
  __pyx_pybuffernd_BOTBACK.data = NULL;
  __pyx_pybuffernd_BOTBACK.rcbuffer = &amp;__pyx_pybuffer_BOTBACK;
  __pyx_pybuffer_LTOPFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_LTOPFRONT.refcount = 0;
  __pyx_pybuffernd_LTOPFRONT.data = NULL;
  __pyx_pybuffernd_LTOPFRONT.rcbuffer = &amp;__pyx_pybuffer_LTOPFRONT;
  __pyx_pybuffer_LTOPBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_LTOPBACK.refcount = 0;
  __pyx_pybuffernd_LTOPBACK.data = NULL;
  __pyx_pybuffernd_LTOPBACK.rcbuffer = &amp;__pyx_pybuffer_LTOPBACK;
  __pyx_pybuffer_LBOTFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_LBOTFRONT.refcount = 0;
  __pyx_pybuffernd_LBOTFRONT.data = NULL;
  __pyx_pybuffernd_LBOTFRONT.rcbuffer = &amp;__pyx_pybuffer_LBOTFRONT;
  __pyx_pybuffer_LBOTBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_LBOTBACK.refcount = 0;
  __pyx_pybuffernd_LBOTBACK.data = NULL;
  __pyx_pybuffernd_LBOTBACK.rcbuffer = &amp;__pyx_pybuffer_LBOTBACK;
  __pyx_pybuffer_RTOPFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_RTOPFRONT.refcount = 0;
  __pyx_pybuffernd_RTOPFRONT.data = NULL;
  __pyx_pybuffernd_RTOPFRONT.rcbuffer = &amp;__pyx_pybuffer_RTOPFRONT;
  __pyx_pybuffer_RTOPBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_RTOPBACK.refcount = 0;
  __pyx_pybuffernd_RTOPBACK.data = NULL;
  __pyx_pybuffernd_RTOPBACK.rcbuffer = &amp;__pyx_pybuffer_RTOPBACK;
  __pyx_pybuffer_RBOTFRONT.pybuffer.buf = NULL;
  __pyx_pybuffer_RBOTFRONT.refcount = 0;
  __pyx_pybuffernd_RBOTFRONT.data = NULL;
  __pyx_pybuffernd_RBOTFRONT.rcbuffer = &amp;__pyx_pybuffer_RBOTFRONT;
  __pyx_pybuffer_RBOTBACK.pybuffer.buf = NULL;
  __pyx_pybuffer_RBOTBACK.refcount = 0;
  __pyx_pybuffernd_RBOTBACK.data = NULL;
  __pyx_pybuffernd_RBOTBACK.rcbuffer = &amp;__pyx_pybuffer_RBOTBACK;
  __pyx_pybuffer_node_type.pybuffer.buf = NULL;
  __pyx_pybuffer_node_type.refcount = 0;
  __pyx_pybuffernd_node_type.data = NULL;
  __pyx_pybuffernd_node_type.rcbuffer = &amp;__pyx_pybuffer_node_type;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_node_type, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_node_type.diminfo[0].strides = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_node_type.diminfo[0].shape = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("springs.get_springs", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ABOVE);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_BELOW);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LEFT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RIGHT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_FRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_BACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LTOP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LBOT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RTOP);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RBOT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_TOPFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_TOPBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_BOTFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_BOTBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LTOPFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LTOPBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LBOTFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_LBOTBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RTOPFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RTOPBACK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RBOTFRONT);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_RBOTBACK);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7springs_7get_springs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7springs_7get_springs(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyArrayObject *__pyx_v_node_type = 0;
  __Pyx_memviewslice __pyx_v_springs = { 0, 0, { 0 }, { 0 }, { 0 } };
  int __pyx_v_max_springs;
  __Pyx_memviewslice __pyx_v_k = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_l_e;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_springs (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_node_type,&amp;__pyx_n_s_springs,&amp;__pyx_n_s_max_springs,&amp;__pyx_n_s_k,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_l_e,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_node_type)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_springs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_springs", 1, 6, 6, 1); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_max_springs)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_springs", 1, 6, 6, 2); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_k)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_springs", 1, 6, 6, 3); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_springs", 1, 6, 6, 4); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_l_e)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_springs", 1, 6, 6, 5); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_springs") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_node_type = ((PyArrayObject *)values[0]);
    __pyx_v_springs = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_springs.memview)) __PYX_ERR(0, 122, __pyx_L3_error)</span>
    __pyx_v_max_springs = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]); if (unlikely((__pyx_v_max_springs == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
    __pyx_v_k = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[3], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_k.memview)) __PYX_ERR(0, 122, __pyx_L3_error)</span>
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[4], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 122, __pyx_L3_error)</span>
    __pyx_v_l_e = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[5]); if (unlikely((__pyx_v_l_e == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_springs", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_springs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_node_type), __pyx_ptype_5numpy_ndarray, 1, "node_type", 0))) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_7springs_6get_springs(__pyx_self, __pyx_v_node_type, __pyx_v_springs, __pyx_v_max_springs, __pyx_v_k, __pyx_v_dim, __pyx_v_l_e);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7springs_6get_springs(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_node_type, __Pyx_memviewslice __pyx_v_springs, int __pyx_v_max_springs, __Pyx_memviewslice __pyx_v_k, __Pyx_memviewslice __pyx_v_dim, double __pyx_v_l_e) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_node_type;
  __Pyx_Buffer __pyx_pybuffer_node_type;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_springs", 0);
  __pyx_pybuffer_node_type.pybuffer.buf = NULL;
  __pyx_pybuffer_node_type.refcount = 0;
  __pyx_pybuffernd_node_type.data = NULL;
  __pyx_pybuffernd_node_type.rcbuffer = &amp;__pyx_pybuffer_node_type;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_node_type, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_node_type.diminfo[0].strides = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_node_type.diminfo[0].shape = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.shape[0];
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_springs.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("springs"); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_k.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("k"); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 122, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_7springs_get_springs(__pyx_v_node_type, __pyx_v_springs, __pyx_v_max_springs, __pyx_v_k, __pyx_v_dim, __pyx_v_l_e, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_springs", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_springs, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_k, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">123</span>: #used in get springs to define which adjacent nodes would be above/below/etc the current node of interest, for deciding which connections are possible based on the node type (a node on the top surface can't be connected to a node above it, there are no nodes above it)</pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>:     cdef int i</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:     cdef np.ndarray[np.npy_bool, ndim=1] ABOVE = np.array([True,False,False,False,True,False,False,True,False,False,True,False,True],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_True);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 125, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_ABOVE = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 125, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_ABOVE.diminfo[0].strides = __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_ABOVE.diminfo[0].shape = __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_ABOVE = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:     cdef np.ndarray[np.npy_bool, ndim=1] BELOW = np.array([False,False,False,True,False,False,True,False,False,True,False,True,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 126, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_BELOW = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 126, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_BELOW.diminfo[0].strides = __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_BELOW.diminfo[0].shape = __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_BELOW = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LEFT = np.array([False,False,False,False,False,True,False,False,False,True,True,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 9, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 10, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_8, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LEFT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LEFT.diminfo[0].strides = __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LEFT.diminfo[0].shape = __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_LEFT = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RIGHT = np.array([False,True,False,False,False,False,True,True,True,False,False,True,True],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, Py_True);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 128, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RIGHT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 128, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RIGHT.diminfo[0].strides = __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RIGHT.diminfo[0].shape = __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_RIGHT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:     cdef np.ndarray[np.npy_bool, ndim=1] FRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 129, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_10, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_FRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 129, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_FRONT.diminfo[0].strides = __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_FRONT.diminfo[0].shape = __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_FRONT = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:     cdef np.ndarray[np.npy_bool, ndim=1] BACK = np.array([False,False,True,True,True,True,False,False,True,True,True,True,True],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_True);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_True);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_True);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_True);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_11, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_BACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_BACK.diminfo[0].strides = __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_BACK.diminfo[0].shape = __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_BACK = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">131</span>:     #combinations of the arrays above to define above and to the left nodes, etc. for deciding which connections are possible based on node type</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LTOP = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_12, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LTOP = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LTOP.diminfo[0].strides = __pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LTOP.diminfo[0].shape = __pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_LTOP = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LBOT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_13, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LBOT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LBOT.diminfo[0].strides = __pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LBOT.diminfo[0].shape = __pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_LBOT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_14, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LFRONT.diminfo[0].strides = __pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LFRONT.diminfo[0].shape = __pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_LFRONT = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_15, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 135, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LBACK.diminfo[0].strides = __pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LBACK.diminfo[0].shape = __pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_LBACK = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RTOP = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_16, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RTOP = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RTOP.diminfo[0].strides = __pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RTOP.diminfo[0].shape = __pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_RTOP = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RBOT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 137, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 137, __pyx_L1_error)</span>
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_17, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RBOT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 137, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RBOT.diminfo[0].strides = __pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RBOT.diminfo[0].shape = __pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_RBOT = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 138, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_18, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RFRONT.diminfo[0].strides = __pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RFRONT.diminfo[0].shape = __pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_RFRONT = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">139</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 139, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_19, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 139, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RBACK.diminfo[0].strides = __pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RBACK.diminfo[0].shape = __pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_RBACK = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:     cdef np.ndarray[np.npy_bool, ndim=1] TOPFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_20, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_TOPFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_TOPFRONT.diminfo[0].strides = __pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_TOPFRONT.diminfo[0].shape = __pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_TOPFRONT = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:     cdef np.ndarray[np.npy_bool, ndim=1] TOPBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_21, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_TOPBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_TOPBACK.diminfo[0].strides = __pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_TOPBACK.diminfo[0].shape = __pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_TOPBACK = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">142</span>:     cdef np.ndarray[np.npy_bool, ndim=1] BOTFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 142, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 142, __pyx_L1_error)</span>
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_22, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_BOTFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 142, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_BOTFRONT.diminfo[0].strides = __pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_BOTFRONT.diminfo[0].shape = __pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_BOTFRONT = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">143</span>:     cdef np.ndarray[np.npy_bool, ndim=1] BOTBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 143, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_23, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_BOTBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_BOTBACK.diminfo[0].strides = __pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_BOTBACK.diminfo[0].shape = __pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_BOTBACK = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">144</span>:     #combinations of the first set of arrays to define nodes which are placed above to the let and behind, etc.</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">145</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LTOPFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 145, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
  __pyx_t_24 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_24, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LTOPFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LTOPFRONT.diminfo[0].strides = __pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LTOPFRONT.diminfo[0].shape = __pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_24 = 0;
  __pyx_v_LTOPFRONT = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">146</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LTOPBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 146, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_25, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LTOPBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LTOPBACK.diminfo[0].strides = __pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LTOPBACK.diminfo[0].shape = __pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_25 = 0;
  __pyx_v_LTOPBACK = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">147</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LBOTFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 147, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 147, __pyx_L1_error)</span>
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_26, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LBOTFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 147, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LBOTFRONT.diminfo[0].strides = __pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LBOTFRONT.diminfo[0].shape = __pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_26 = 0;
  __pyx_v_LBOTFRONT = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">148</span>:     cdef np.ndarray[np.npy_bool, ndim=1] LBOTBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 148, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 148, __pyx_L1_error)</span>
  __pyx_t_27 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_27, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_LBOTBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 148, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_LBOTBACK.diminfo[0].strides = __pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_LBOTBACK.diminfo[0].shape = __pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_27 = 0;
  __pyx_v_LBOTBACK = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">149</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RTOPFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_4, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 149, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
  __pyx_t_28 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_28, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RTOPFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RTOPFRONT.diminfo[0].strides = __pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RTOPFRONT.diminfo[0].shape = __pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_28 = 0;
  __pyx_v_RTOPFRONT = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">150</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RTOPBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_3, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
  __pyx_t_29 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_29, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RTOPBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RTOPBACK.diminfo[0].strides = __pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RTOPBACK.diminfo[0].shape = __pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_29 = 0;
  __pyx_v_RTOPBACK = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">151</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RBOTFRONT = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_3, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
  __pyx_t_30 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_30, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RBOTFRONT = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RBOTFRONT.diminfo[0].strides = __pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RBOTFRONT.diminfo[0].shape = __pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_30 = 0;
  __pyx_v_RBOTFRONT = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">152</span>:     cdef np.ndarray[np.npy_bool, ndim=1] RBOTBACK = np.array([False,False,False,False,False,False,False,False,False,False,False,False,False],dtype=np.bool_)</pre>
<pre class='cython code score-65 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_array);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 0, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 1, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 2, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 3, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 4, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 5, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 6, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 7, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 8, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 9, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 10, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 11, Py_False);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_5, 12, Py_False);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_bool);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 152, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
  __pyx_t_31 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_31, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_RBOTBACK = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_RBOTBACK.diminfo[0].strides = __pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_RBOTBACK.diminfo[0].shape = __pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_31 = 0;
  __pyx_v_RBOTBACK = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">153</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">154</span>:     for i in range(13):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_32 = 0; __pyx_t_32 &lt; 13; __pyx_t_32+=1) {
    __pyx_v_i = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">155</span>:         LTOP[i] = LEFT[i] or ABOVE[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L5_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L5_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LTOP.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LTOP.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>:         LBOT[i] = LEFT[i] or BELOW[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L7_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LBOT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LBOT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>:         LFRONT[i] = LEFT[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L9_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:         LBACK[i] = LEFT[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L11_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>:         RTOP[i] = RIGHT[i] or ABOVE[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L13_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L13_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RTOP.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RTOP.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:         RBOT[i] = RIGHT[i] or BELOW[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L15_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L15_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RBOT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RBOT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:         RFRONT[i] = RIGHT[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L17_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L17_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>:         RBACK[i] = RIGHT[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L19_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:         TOPFRONT[i] = ABOVE[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L21_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_TOPFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_TOPFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:         TOPBACK[i] = ABOVE[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L23_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L23_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_TOPBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_TOPBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>:         BOTFRONT[i] = BELOW[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L25_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L25_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BOTFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BOTFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:         BOTBACK[i] = BELOW[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L27_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L27_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BOTBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BOTBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>:         #combinations of the first set of arrays to define nodes which are placed above to the let and behind, etc.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:         LTOPFRONT[i] = LEFT[i] or ABOVE[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L29_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L29_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L29_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LTOPFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LTOPFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:         LTOPBACK[i] = LEFT[i] or ABOVE[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L32_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LTOPBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LTOPBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:         LBOTFRONT[i] = LEFT[i] or BELOW[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L35_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L35_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L35_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LBOTFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LBOTFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>:         LBOTBACK[i] = LEFT[i] or BELOW[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LEFT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LEFT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L38_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L38_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L38_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_LBOTBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_LBOTBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:         RTOPFRONT[i] = RIGHT[i] or ABOVE[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L41_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L41_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L41_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RTOPFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RTOPFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">173</span>:         RTOPBACK[i] = RIGHT[i] or ABOVE[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L44_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_ABOVE.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_ABOVE.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L44_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L44_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RTOPBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RTOPBACK.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>:         RBOTFRONT[i] = RIGHT[i] or BELOW[i] or FRONT[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L47_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L47_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_FRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_FRONT.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L47_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RBOTFRONT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RBOTFRONT.diminfo[0].strides) = __pyx_t_33;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>:         RBOTBACK[i] = RIGHT[i] or BELOW[i] or BACK[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RIGHT.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RIGHT.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L50_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BELOW.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BELOW.diminfo[0].strides));
    if (!__pyx_t_35) {
    } else {
      __pyx_t_33 = __pyx_t_35;
      goto __pyx_L50_bool_binop_done;
    }
    __pyx_t_34 = __pyx_v_i;
    __pyx_t_35 = (*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_BACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_BACK.diminfo[0].strides));
    __pyx_t_33 = __pyx_t_35;
    __pyx_L50_bool_binop_done:;
    __pyx_t_34 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_RBOTBACK.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_RBOTBACK.diminfo[0].strides) = __pyx_t_33;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">176</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>:     cdef int j</pre>
<pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:     cdef int Nz = np.round(dim[2]/l_e + 1).astype(np.int64)</pre>
<pre class='cython code score-61 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_round);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_34 = 2;
  __pyx_t_36 = (*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_34 * __pyx_v_dim.strides[0]) )));
  if (unlikely(__pyx_v_l_e == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_t_36 / __pyx_v_l_e) + 1.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_5 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
    }
  }
  __pyx_t_4 = (__pyx_t_5) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_32 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_32 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Nz = __pyx_t_32;
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">179</span>:     cdef int Nx = np.round(dim[0]/l_e + 1).astype(np.int64)</pre>
<pre class='cython code score-61 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_round);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_34 = 0;
  __pyx_t_36 = (*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_34 * __pyx_v_dim.strides[0]) )));
  if (unlikely(__pyx_v_l_e == 0)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(((__pyx_t_36 / __pyx_v_l_e) + 1.0));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_astype);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_int64);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
    }
  }
  __pyx_t_4 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_32 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4); if (unlikely((__pyx_t_32 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 179, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Nx = __pyx_t_32;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>:     cdef int nodes_per_line = Nz</pre>
<pre class='cython code score-0 '>  __pyx_v_nodes_per_line = __pyx_v_Nz;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>:     cdef int nodes_per_plane = Nx*Nz</pre>
<pre class='cython code score-0 '>  __pyx_v_nodes_per_plane = (__pyx_v_Nx * __pyx_v_Nz);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">182</span>:     cdef double face_spring_length = sqrt(2)*l_e</pre>
<pre class='cython code score-0 '>  __pyx_v_face_spring_length = (sqrt(2.0) * __pyx_v_l_e);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>:     cdef double center_diagonal_length = sqrt(3)*l_e</pre>
<pre class='cython code score-0 '>  __pyx_v_center_diagonal_length = (sqrt(3.0) * __pyx_v_l_e);
</pre><pre class="cython line score-0">&#xA0;<span class="">184</span>:     # cdef np.ndarray[np.float64_t,ndim=2] springs = np.empty((max_springs,4),dtype=np.float64)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">185</span>:     cdef int spring_counter = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_spring_counter = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>:     cdef int[13] adjacent_node_indices = np.empty((13,),dtype=np.int32)</pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_int_13);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__7, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(__Pyx_carray_from_py_int(__pyx_t_1, __pyx_t_37, 13) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  memcpy(&amp;(__pyx_v_adjacent_node_indices[0]), __pyx_t_37, sizeof(__pyx_v_adjacent_node_indices[0]) * (13));
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_tuple__6);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:     for i in range(node_type.shape[0]):#there are 26 adjacent nodes that could be connected, but because i only want unique connections (i &lt; other_node_index) and i'm iterating over i, i can ignore the 13 that would have lower node indices</pre>
<pre class='cython code score-0 '>  __pyx_t_38 = (__pyx_v_node_type-&gt;dimensions[0]);
  __pyx_t_39 = __pyx_t_38;
  for (__pyx_t_32 = 0; __pyx_t_32 &lt; __pyx_t_39; __pyx_t_32+=1) {
    __pyx_v_i = __pyx_t_32;
</pre><pre class="cython line score-0">&#xA0;<span class="">188</span>:         #edge type connections</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:         adjacent_node_indices[0] = i + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[0]) = (__pyx_v_i + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:         adjacent_node_indices[1] = i + nodes_per_line</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[1]) = (__pyx_v_i + __pyx_v_nodes_per_line);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:         adjacent_node_indices[2] = i + nodes_per_plane</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[2]) = (__pyx_v_i + __pyx_v_nodes_per_plane);
</pre><pre class="cython line score-0">&#xA0;<span class="">192</span>:         #face type connections</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>:         adjacent_node_indices[3] = i + nodes_per_plane - 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[3]) = ((__pyx_v_i + __pyx_v_nodes_per_plane) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>:         adjacent_node_indices[4] = i + nodes_per_plane + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[4]) = ((__pyx_v_i + __pyx_v_nodes_per_plane) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:         adjacent_node_indices[5] = i - nodes_per_line + nodes_per_plane</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[5]) = ((__pyx_v_i - __pyx_v_nodes_per_line) + __pyx_v_nodes_per_plane);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:         adjacent_node_indices[6] = i + nodes_per_line - 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[6]) = ((__pyx_v_i + __pyx_v_nodes_per_line) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>:         adjacent_node_indices[7] = i + nodes_per_line + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[7]) = ((__pyx_v_i + __pyx_v_nodes_per_line) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:         adjacent_node_indices[8] = i + nodes_per_line + nodes_per_plane</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[8]) = ((__pyx_v_i + __pyx_v_nodes_per_line) + __pyx_v_nodes_per_plane);
</pre><pre class="cython line score-0">&#xA0;<span class="">199</span>:         #center diagonal type connections</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:         adjacent_node_indices[9] = i - nodes_per_line + nodes_per_plane - 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[9]) = (((__pyx_v_i - __pyx_v_nodes_per_line) + __pyx_v_nodes_per_plane) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:         adjacent_node_indices[10] = i - nodes_per_line + nodes_per_plane + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[10]) = (((__pyx_v_i - __pyx_v_nodes_per_line) + __pyx_v_nodes_per_plane) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:         adjacent_node_indices[11] = i + nodes_per_line + nodes_per_plane - 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[11]) = (((__pyx_v_i + __pyx_v_nodes_per_line) + __pyx_v_nodes_per_plane) - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:         adjacent_node_indices[12] = i + nodes_per_line + nodes_per_plane + 1</pre>
<pre class='cython code score-0 '>    (__pyx_v_adjacent_node_indices[12]) = (((__pyx_v_i + __pyx_v_nodes_per_line) + __pyx_v_nodes_per_plane) + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>:         #now i need to include the logic for checking based on the node type whether or not there would be nodes to the left, right, above, below or behind (any node in front (lower y value) will always be a lower node index and so won't need to be considered)</pre>
<pre class="cython line score-0">&#xA0;<span class="">205</span>:         #i should group the adjacent nodes so that they are edge springs, then face springs, then center diagonal springs</pre>
<pre class="cython line score-0">&#xA0;<span class="">206</span>: #defining which of the potential node connections involve translations above/below/etc</pre>
<pre class="cython line score-0">&#xA0;<span class="">207</span>: #just define the connections (first two elements of the spring variable. maybe the length? and get the stiffness set later with it's own functionality?)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:         if node_type[i] == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 0) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:             for j in range(3):</pre>
<pre class='cython code score-0 '>      for (__pyx_t_41 = 0; __pyx_t_41 &lt; 3; __pyx_t_41+=1) {
        __pyx_v_j = __pyx_t_41;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:                 springs[spring_counter,0] = i</pre>
<pre class='cython code score-0 '>        __pyx_t_34 = __pyx_v_spring_counter;
        __pyx_t_42 = 0;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_34 * __pyx_v_springs.strides[0]) )) + __pyx_t_42)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:                 springs[spring_counter,1] = adjacent_node_indices[j]</pre>
<pre class='cython code score-0 '>        __pyx_t_42 = __pyx_v_spring_counter;
        __pyx_t_34 = 1;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_42 * __pyx_v_springs.strides[0]) )) + __pyx_t_34)) )) = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:                 springs[spring_counter,2] = k[0]</pre>
<pre class='cython code score-0 '>        __pyx_t_34 = 0;
        __pyx_t_42 = __pyx_v_spring_counter;
        __pyx_t_43 = 2;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_42 * __pyx_v_springs.strides[0]) )) + __pyx_t_43)) )) = (*((double *) ( /* dim=0 */ (__pyx_v_k.data + __pyx_t_34 * __pyx_v_k.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>:                 springs[spring_counter,3] = l_e</pre>
<pre class='cython code score-0 '>        __pyx_t_34 = __pyx_v_spring_counter;
        __pyx_t_43 = 3;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_34 * __pyx_v_springs.strides[0]) )) + __pyx_t_43)) )) = __pyx_v_l_e;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:                 spring_counter += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_spring_counter = (__pyx_v_spring_counter + 1);
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:             for j in range(3,9):</pre>
<pre class='cython code score-0 '>      for (__pyx_t_41 = 3; __pyx_t_41 &lt; 9; __pyx_t_41+=1) {
        __pyx_v_j = __pyx_t_41;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:                 springs[spring_counter,0] = i</pre>
<pre class='cython code score-0 '>        __pyx_t_43 = __pyx_v_spring_counter;
        __pyx_t_34 = 0;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_43 * __pyx_v_springs.strides[0]) )) + __pyx_t_34)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:                 springs[spring_counter,1] = adjacent_node_indices[j]</pre>
<pre class='cython code score-0 '>        __pyx_t_34 = __pyx_v_spring_counter;
        __pyx_t_43 = 1;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_34 * __pyx_v_springs.strides[0]) )) + __pyx_t_43)) )) = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:                 springs[spring_counter,2] = k[1]</pre>
<pre class='cython code score-0 '>        __pyx_t_43 = 1;
        __pyx_t_34 = __pyx_v_spring_counter;
        __pyx_t_42 = 2;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_34 * __pyx_v_springs.strides[0]) )) + __pyx_t_42)) )) = (*((double *) ( /* dim=0 */ (__pyx_v_k.data + __pyx_t_43 * __pyx_v_k.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:                 springs[spring_counter,3] = face_spring_length</pre>
<pre class='cython code score-0 '>        __pyx_t_43 = __pyx_v_spring_counter;
        __pyx_t_42 = 3;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_43 * __pyx_v_springs.strides[0]) )) + __pyx_t_42)) )) = __pyx_v_face_spring_length;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:                 spring_counter += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_spring_counter = (__pyx_v_spring_counter + 1);
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:             for j in range(9,13):</pre>
<pre class='cython code score-0 '>      for (__pyx_t_41 = 9; __pyx_t_41 &lt; 13; __pyx_t_41+=1) {
        __pyx_v_j = __pyx_t_41;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:                 springs[spring_counter,0] = i</pre>
<pre class='cython code score-0 '>        __pyx_t_42 = __pyx_v_spring_counter;
        __pyx_t_43 = 0;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_42 * __pyx_v_springs.strides[0]) )) + __pyx_t_43)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:                 springs[spring_counter,1] = adjacent_node_indices[j]</pre>
<pre class='cython code score-0 '>        __pyx_t_43 = __pyx_v_spring_counter;
        __pyx_t_42 = 1;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_43 * __pyx_v_springs.strides[0]) )) + __pyx_t_42)) )) = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:                 springs[spring_counter,2] = k[2]</pre>
<pre class='cython code score-0 '>        __pyx_t_42 = 2;
        __pyx_t_43 = __pyx_v_spring_counter;
        __pyx_t_34 = 2;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_43 * __pyx_v_springs.strides[0]) )) + __pyx_t_34)) )) = (*((double *) ( /* dim=0 */ (__pyx_v_k.data + __pyx_t_42 * __pyx_v_k.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:                 springs[spring_counter,3] = center_diagonal_length</pre>
<pre class='cython code score-0 '>        __pyx_t_42 = __pyx_v_spring_counter;
        __pyx_t_34 = 3;
        *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_42 * __pyx_v_springs.strides[0]) )) + __pyx_t_34)) )) = __pyx_v_center_diagonal_length;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:                 spring_counter += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_spring_counter = (__pyx_v_spring_counter + 1);
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">227</span>:             #the logic for springs tiffness setting should be established in a separate function(s)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         elif node_type[i] == 1:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 1) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LEFT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LEFT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:         elif node_type[i] == 2:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 2) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">231</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RIGHT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RIGHT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:         elif node_type[i] == 3:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 3) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, ABOVE, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_ABOVE), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:         elif node_type[i] == 4:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 4) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, BELOW, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_BELOW), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:         elif node_type[i] == 5:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 5) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, FRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_FRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:         elif node_type[i] == 6:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 6) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, BACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_BACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:         elif node_type[i] == 7:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 7) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LTOP, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LTOP), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:         elif node_type[i] == 8:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 8) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LBOT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LBOT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:         elif node_type[i] == 9:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 9) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:         elif node_type[i] == 10:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 10) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>:         elif node_type[i] == 11:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 11) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RTOP, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RTOP), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>:         elif node_type[i] == 12:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 12) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RBOT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RBOT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:         elif node_type[i] == 13:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 13) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:         elif node_type[i] == 14:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 14) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:         elif node_type[i] == 15:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 15) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, TOPFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_TOPFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>:         elif node_type[i] == 16:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 16) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, TOPBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_TOPBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:         elif node_type[i] == 17:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 17) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, BOTFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_BOTFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:         elif node_type[i] == 18:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 18) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, BOTBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_BOTBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:         elif node_type[i] == 19:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 19) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LBOTFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LBOTFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:         elif node_type[i] == 20:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 20) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RBOTFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RBOTFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:         elif node_type[i] == 21:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 21) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LBOTBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LBOTBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:         elif node_type[i] == 22:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 22) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LTOPFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LTOPFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:         elif node_type[i] == 23:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 23) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RBOTBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RBOTBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>:         elif node_type[i] == 24:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 24) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>:            spring_counter = set_connection_type_conditional(i, node_type, springs, RTOPFRONT, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RTOPFRONT), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:         elif node_type[i] == 25:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 25) != 0);
    if (__pyx_t_40) {
/* … */
      goto __pyx_L55;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, LTOPBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_LTOPBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:         elif node_type[i] == 26:</pre>
<pre class='cython code score-0 '>    __pyx_t_34 = __pyx_v_i;
    __pyx_t_40 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_node_type.diminfo[0].strides)) == 26) != 0);
    if (__pyx_t_40) {
/* … */
    }
    __pyx_L55:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:             spring_counter = set_connection_type_conditional(i, node_type, springs, RTOPBACK, adjacent_node_indices, spring_counter, l_e, face_spring_length, center_diagonal_length, k)</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = __pyx_f_7springs_set_connection_type_conditional(__pyx_v_i, ((PyArrayObject *)__pyx_v_node_type), __pyx_v_springs, ((PyArrayObject *)__pyx_v_RTOPBACK), __pyx_v_adjacent_node_indices, __pyx_v_spring_counter, __pyx_v_l_e, __pyx_v_face_spring_length, __pyx_v_center_diagonal_length, __pyx_v_k);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:     return spring_counter#springs</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_spring_counter;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">281</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">282</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">283</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-96" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>: cpdef np.ndarray[np.int8_t, ndim=1] get_node_type(int n_nodes, dict boundaries, double[:] dim, double l_e):</pre>
<pre class='cython code score-96 '>static PyObject *__pyx_pw_7springs_9get_node_type(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyArrayObject *__pyx_f_7springs_get_node_type(int __pyx_v_n_nodes, PyObject *__pyx_v_boundaries, __Pyx_memviewslice __pyx_v_dim, double __pyx_v_l_e, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyArrayObject *__pyx_v_node_type = 0;
  PyObject *__pyx_v_left = 0;
  PyObject *__pyx_v_right = 0;
  PyObject *__pyx_v_top = 0;
  PyObject *__pyx_v_bottom = 0;
  PyObject *__pyx_v_front = 0;
  PyObject *__pyx_v_back = 0;
  PyObject *__pyx_v_tmp_var = NULL;
  PyArrayObject *__pyx_v_corners = 0;
  PyArrayObject *__pyx_v_corner_indices = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_corner_indices;
  __Pyx_Buffer __pyx_pybuffer_corner_indices;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_corners;
  __Pyx_Buffer __pyx_pybuffer_corners;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_node_type;
  __Pyx_Buffer __pyx_pybuffer_node_type;
  PyArrayObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_type", 0);
  __pyx_pybuffer_node_type.pybuffer.buf = NULL;
  __pyx_pybuffer_node_type.refcount = 0;
  __pyx_pybuffernd_node_type.data = NULL;
  __pyx_pybuffernd_node_type.rcbuffer = &amp;__pyx_pybuffer_node_type;
  __pyx_pybuffer_corners.pybuffer.buf = NULL;
  __pyx_pybuffer_corners.refcount = 0;
  __pyx_pybuffernd_corners.data = NULL;
  __pyx_pybuffernd_corners.rcbuffer = &amp;__pyx_pybuffer_corners;
  __pyx_pybuffer_corner_indices.pybuffer.buf = NULL;
  __pyx_pybuffer_corner_indices.refcount = 0;
  __pyx_pybuffernd_corner_indices.data = NULL;
  __pyx_pybuffernd_corner_indices.rcbuffer = &amp;__pyx_pybuffer_corner_indices;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_node_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_node_type);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_left);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_right);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_top);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bottom);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_front);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_back);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_tmp_var);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_corners);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_corner_indices);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_7springs_9get_node_type(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_7springs_9get_node_type(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_n_nodes;
  PyObject *__pyx_v_boundaries = 0;
  __Pyx_memviewslice __pyx_v_dim = { 0, 0, { 0 }, { 0 }, { 0 } };
  double __pyx_v_l_e;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_type (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_n_nodes,&amp;__pyx_n_s_boundaries,&amp;__pyx_n_s_dim,&amp;__pyx_n_s_l_e,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_n_nodes)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_boundaries)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_node_type", 1, 4, 4, 1); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dim)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_node_type", 1, 4, 4, 2); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_l_e)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_node_type", 1, 4, 4, 3); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_node_type") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_n_nodes = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_n_nodes == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
    __pyx_v_boundaries = ((PyObject*)values[1]);
    __pyx_v_dim = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_ds_double</span>(values[2], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_dim.memview)) __PYX_ERR(0, 284, __pyx_L3_error)</span>
    __pyx_v_l_e = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[3]); if (unlikely((__pyx_v_l_e == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_node_type", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_node_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_boundaries), (&amp;PyDict_Type), 1, "boundaries", 1))) <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_7springs_8get_node_type(__pyx_self, __pyx_v_n_nodes, __pyx_v_boundaries, __pyx_v_dim, __pyx_v_l_e);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_7springs_8get_node_type(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_n_nodes, PyObject *__pyx_v_boundaries, __Pyx_memviewslice __pyx_v_dim, double __pyx_v_l_e) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_node_type", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  if (unlikely(!__pyx_v_dim.memview)) { <span class='pyx_c_api'>__Pyx_RaiseUnboundLocalError</span>("dim"); <span class='error_goto'>__PYX_ERR(0, 284, __pyx_L1_error)</span> }
  __pyx_t_1 = ((PyObject *)__pyx_f_7springs_get_node_type(__pyx_v_n_nodes, __pyx_v_boundaries, __pyx_v_dim, __pyx_v_l_e, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("springs.get_node_type", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_dim, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:     cdef np.ndarray[np.int8_t, ndim=1] node_type = np.zeros((n_nodes,),dtype=np.int8)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n_nodes);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_int8);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 285, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_6, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_node_type = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 285, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_node_type.diminfo[0].strides = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_node_type.diminfo[0].shape = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_node_type = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">286</span>:     #zero represents interior nodes, first identify surface nodes, then edges, then corners (edge nodes are surface nodes, corner nodes are edge nodes)</pre>
<pre class="cython line score-0">&#xA0;<span class="">287</span>:     #using sets for intersection method to determine edges</pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:     cdef set left = set(boundaries['left'])</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 288, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_left);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySet_New</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 288, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_left = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>:     cdef set right = set(boundaries['right'])</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 289, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_right);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PySet_New</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_right = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>:     cdef set top = set(boundaries['top'])</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 290, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_top);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 290, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySet_New</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 290, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_top = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">291</span>:     cdef set bottom = set(boundaries['bot'])</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 291, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_bot);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PySet_New</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 291, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_bottom = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>:     cdef set front = set(boundaries['front'])</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 292, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_front);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySet_New</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_front = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:     cdef set back = set(boundaries['back'])</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 293, __pyx_L1_error)</span>
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_back);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='py_c_api'>PySet_New</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 293, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_back = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">294</span>:     node_type[boundaries['left']] = 1</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_left);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_t_5, __pyx_int_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 294, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:     node_type[boundaries['right']] = 2</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_right);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_t_5, __pyx_int_2) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>:     node_type[boundaries['top']] = 3</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_top);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_t_5, __pyx_int_3) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 296, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:     node_type[boundaries['bot']] = 4</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_bot);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_t_5, __pyx_int_4) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:     node_type[boundaries['front']] = 5</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_front);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_t_5, __pyx_int_5) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:     node_type[boundaries['back']] = 6</pre>
<pre class='cython code score-13 '>  if (unlikely(__pyx_v_boundaries == Py_None)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
    <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
  }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_boundaries, __pyx_n_u_back);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_t_5, __pyx_int_6) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">300</span>:     # node_type[boundaries['left']] = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>:     # node_type[boundaries['right']] = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>:     # node_type[boundaries['top']] = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>:     # node_type[boundaries['bot']] = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>:     # node_type[boundaries['front']] = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>:     # node_type[boundaries['back']] = 1</pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>:     #now edges</pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>:     #unpacking the set members, as sets can't be used for magic indexing</pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">308</span>:     *tmp_var, = left.intersection(top)</pre>
<pre class='cython code score-6 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_left, __pyx_v_top);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tmp_var = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">309</span>:     node_type[tmp_var] = 7</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_7) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 309, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>:     *tmp_var, = left.intersection(bottom)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_left, __pyx_v_bottom);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:     node_type[tmp_var] = 8</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_8) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 311, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:     *tmp_var, = left.intersection(front)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_left, __pyx_v_front);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:     node_type[tmp_var] = 9</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_9) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 313, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:     *tmp_var, = left.intersection(back)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_left, __pyx_v_back);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 314, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:     node_type[tmp_var] = 10</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_10) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:     *tmp_var, = right.intersection(top)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_right, __pyx_v_top);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 316, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:     node_type[tmp_var] = 11</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_11) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:     *tmp_var, = right.intersection(bottom)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_right, __pyx_v_bottom);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:     node_type[tmp_var] = 12</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_12) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 319, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:     *tmp_var, = right.intersection(front)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_right, __pyx_v_front);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:     node_type[tmp_var] = 13</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_13) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 321, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>:     *tmp_var, = right.intersection(back)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_right, __pyx_v_back);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 322, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>:     node_type[tmp_var] = 14</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_14) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:     *tmp_var, = top.intersection(front)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_top, __pyx_v_front);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 324, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:     node_type[tmp_var] = 15</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_15) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 325, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:     *tmp_var, = top.intersection(back)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_top, __pyx_v_back);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:     node_type[tmp_var] = 16</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_16) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:     *tmp_var, = bottom.intersection(front)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_bottom, __pyx_v_front);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:     node_type[tmp_var] = 17</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_17) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 329, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:     *tmp_var, = bottom.intersection(back)</pre>
<pre class='cython code score-7 '>  __pyx_t_5 = __Pyx_CallUnboundCMethod1(&amp;__pyx_umethod_PySet_Type_intersection, __pyx_v_bottom, __pyx_v_back);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='py_c_api'>PySequence_List</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_tmp_var, ((PyObject*)__pyx_t_3));
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:     node_type[tmp_var] = 18</pre>
<pre class='cython code score-5 '>  if (unlikely(<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_node_type), __pyx_v_tmp_var, __pyx_int_18) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 331, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">332</span>:     # *tmp_var, = left.intersection(top)</pre>
<pre class="cython line score-0">&#xA0;<span class="">333</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">334</span>:     # *tmp_var, = left.intersection(bottom)</pre>
<pre class="cython line score-0">&#xA0;<span class="">335</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">336</span>:     # *tmp_var, = left.intersection(front)</pre>
<pre class="cython line score-0">&#xA0;<span class="">337</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:     # *tmp_var, = left.intersection(back)</pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>:     # *tmp_var, = right.intersection(top)</pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>:     # *tmp_var, = right.intersection(bottom)</pre>
<pre class="cython line score-0">&#xA0;<span class="">343</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">344</span>:     # *tmp_var, = right.intersection(front)</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">346</span>:     # *tmp_var, = right.intersection(back)</pre>
<pre class="cython line score-0">&#xA0;<span class="">347</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">348</span>:     # *tmp_var, = top.intersection(front)</pre>
<pre class="cython line score-0">&#xA0;<span class="">349</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">350</span>:     # *tmp_var, = top.intersection(back)</pre>
<pre class="cython line score-0">&#xA0;<span class="">351</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">352</span>:     # *tmp_var, = bottom.intersection(front)</pre>
<pre class="cython line score-0">&#xA0;<span class="">353</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>:     # *tmp_var, = bottom.intersection(back)</pre>
<pre class="cython line score-0">&#xA0;<span class="">355</span>:     # node_type[tmp_var] = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>:     #</pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:     cdef np.ndarray[np.float64_t, ndim=2] corners = np.zeros((8,3),dtype=np.float64)</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_tuple__2, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 357, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_7, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_corners = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 357, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_corners.diminfo[0].strides = __pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_corners.diminfo[0].shape = __pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_corners.diminfo[1].strides = __pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_corners.diminfo[1].shape = __pyx_pybuffernd_corners.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_corners = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>:     corners[1][0] = dim[0]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:     corners[2][1] = dim[1]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 1;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 1, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:     corners[3][2] = dim[2]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 2;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 3, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 2, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:     corners[4][0] = dim[0]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:     corners[4][1] = dim[1]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 1;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 4, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 1, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:     corners[5][0] = dim[0]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:     corners[5][2] = dim[2]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 2;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 5, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 2, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">365</span>:     corners[6][1] = dim[1]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 1;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 365, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 1, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:     corners[6][2] = dim[2]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 2;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 6, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 2, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:     corners[7][0] = dim[0]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 0, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 367, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:     corners[7][1] = dim[1]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 1;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 368, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 1, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:     corners[7][2] = dim[2]</pre>
<pre class='cython code score-11 '>  __pyx_t_8 = 2;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>((*((double *) ( /* dim=0 */ (__pyx_v_dim.data + __pyx_t_8 * __pyx_v_dim.strides[0]) ))));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(((PyObject *)__pyx_v_corners), 7, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(<span class='pyx_c_api'>__Pyx_SetItemInt</span>(__pyx_t_5, 2, __pyx_t_2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:     cdef np.ndarray[np.int32_t, ndim=1] corner_indices = np.empty((8,),dtype=np.int32)</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_empty);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_int32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_tuple__4, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_t_9, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_corner_indices = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_corner_indices.diminfo[0].strides = __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_corner_indices.diminfo[0].shape = __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_corner_indices = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:     corner_indices = get_row_indices(corners,l_e,dim)</pre>
<pre class='cython code score-21 '>  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dsds_double</span>(((PyObject *)__pyx_v_corners), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_10.memview)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  __pyx_t_1 = ((PyObject *)__pyx_f_7springs_get_row_indices(__pyx_t_10, __pyx_v_l_e, __pyx_v_dim));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_10, 1);
  __pyx_t_10.memview = NULL;
  __pyx_t_10.data = NULL;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer);
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_11 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_12, &amp;__pyx_t_13, &amp;__pyx_t_14);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_corner_indices, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      }
      __pyx_t_12 = __pyx_t_13 = __pyx_t_14 = 0;
    }
    __pyx_pybuffernd_corner_indices.diminfo[0].strides = __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_corner_indices.diminfo[0].shape = __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 371, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_corner_indices, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">372</span>:     # node_type[corner_indices] = 3</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:     node_type[corner_indices[0]] = 19#leftbotfront</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 0;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">374</span>:     node_type[corner_indices[1]] = 20#rightbotfront</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 1;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">375</span>:     node_type[corner_indices[2]] = 21#leftbotback</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 2;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 21;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">376</span>:     node_type[corner_indices[3]] = 22#lefttopfront</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 3;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 22;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:     node_type[corner_indices[4]] = 23#rightbotback</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 4;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">378</span>:     node_type[corner_indices[5]] = 24#righttopfront</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 5;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 24;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">379</span>:     node_type[corner_indices[6]] = 25#lefttopback</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 6;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 25;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:     node_type[corner_indices[7]] = 26#righttopback</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = 7;
  __pyx_t_15 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int32_t *, __pyx_pybuffernd_corner_indices.rcbuffer-&gt;pybuffer.buf, __pyx_t_8, __pyx_pybuffernd_corner_indices.diminfo[0].strides));
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_node_type.diminfo[0].strides) = 26;
</pre><pre class="cython line score-0">&#xA0;<span class="">381</span>:     #i can adjust this function to return values from 0 to 26, reflecting interior, the 6 different surfaces, 12 edges, and 8 corner types, to get more detailed information about the node type for assigning spring stiffness and determining adjacent node connectivity</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:     return node_type</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_node_type));
  __pyx_r = ((PyArrayObject *)__pyx_v_node_type);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">383</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">384</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">385</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">386</span>: @cython.boundscheck(False)</pre>
<pre class="cython line score-0">&#xA0;<span class="">387</span>: @cython.wraparound(False)</pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>: cdef int set_connection_type_conditional(int i, np.ndarray[np.int8_t,ndim=1] node_type, double[:,::1] springs, np.ndarray[np.npy_bool, ndim=1] disallowed_connections, int[13] adjacent_node_indices, int spring_counter, double l_e, double face_spring_length, double center_diagonal_length, double[:] k):</pre>
<pre class='cython code score-18 '>static int __pyx_f_7springs_set_connection_type_conditional(int __pyx_v_i, PyArrayObject *__pyx_v_node_type, __Pyx_memviewslice __pyx_v_springs, PyArrayObject *__pyx_v_disallowed_connections, int *__pyx_v_adjacent_node_indices, int __pyx_v_spring_counter, double __pyx_v_l_e, double __pyx_v_face_spring_length, double __pyx_v_center_diagonal_length, __Pyx_memviewslice __pyx_v_k) {
  int __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_disallowed_connections;
  __Pyx_Buffer __pyx_pybuffer_disallowed_connections;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_node_type;
  __Pyx_Buffer __pyx_pybuffer_node_type;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_connection_type_conditional", 0);
  __pyx_pybuffer_node_type.pybuffer.buf = NULL;
  __pyx_pybuffer_node_type.refcount = 0;
  __pyx_pybuffernd_node_type.data = NULL;
  __pyx_pybuffernd_node_type.rcbuffer = &amp;__pyx_pybuffer_node_type;
  __pyx_pybuffer_disallowed_connections.pybuffer.buf = NULL;
  __pyx_pybuffer_disallowed_connections.refcount = 0;
  __pyx_pybuffernd_disallowed_connections.data = NULL;
  __pyx_pybuffernd_disallowed_connections.rcbuffer = &amp;__pyx_pybuffer_disallowed_connections;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_node_type, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_int8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_node_type.diminfo[0].strides = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_node_type.diminfo[0].shape = __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_disallowed_connections, &amp;__Pyx_TypeInfo_nn_npy_bool, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 388, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_disallowed_connections.diminfo[0].strides = __pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_disallowed_connections.diminfo[0].shape = __pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("springs.set_connection_type_conditional", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">389</span>:     cdef int j</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:     for j in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_j = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:         if not disallowed_connections[j]:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = __pyx_v_j;
    __pyx_t_3 = ((!((*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer.buf, __pyx_t_2, __pyx_pybuffernd_disallowed_connections.diminfo[0].strides)) != 0)) != 0);
    if (__pyx_t_3) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:             springs[spring_counter,0] = i</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_spring_counter;
      __pyx_t_4 = 0;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_2 * __pyx_v_springs.strides[0]) )) + __pyx_t_4)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:             springs[spring_counter,1] = adjacent_node_indices[j]</pre>
<pre class='cython code score-0 '>      __pyx_t_4 = __pyx_v_spring_counter;
      __pyx_t_2 = 1;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_4 * __pyx_v_springs.strides[0]) )) + __pyx_t_2)) )) = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:             springs[spring_counter,3] = l_e</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_spring_counter;
      __pyx_t_4 = 3;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_2 * __pyx_v_springs.strides[0]) )) + __pyx_t_4)) )) = __pyx_v_l_e;
</pre><pre class="cython line score-0">&#xA0;<span class="">395</span>:             #set spring value</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:             springs[spring_counter,2] = get_edge_stiffness(node_type[i], node_type[adjacent_node_indices[j]], k[0])</pre>
<pre class='cython code score-0 '>      __pyx_t_4 = __pyx_v_i;
      __pyx_t_2 = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
      __pyx_t_5 = 0;
      __pyx_t_6 = __pyx_v_spring_counter;
      __pyx_t_7 = 2;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_6 * __pyx_v_springs.strides[0]) )) + __pyx_t_7)) )) = __pyx_f_7springs_get_edge_stiffness((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_node_type.diminfo[0].strides)), (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_2, __pyx_pybuffernd_node_type.diminfo[0].strides)), (*((double *) ( /* dim=0 */ (__pyx_v_k.data + __pyx_t_5 * __pyx_v_k.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:             spring_counter += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = (__pyx_v_spring_counter + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">398</span>:     for j in range(3,9):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 3; __pyx_t_1 &lt; 9; __pyx_t_1+=1) {
    __pyx_v_j = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:         if not disallowed_connections[j]:</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_j;
    __pyx_t_3 = ((!((*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_disallowed_connections.diminfo[0].strides)) != 0)) != 0);
    if (__pyx_t_3) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:             springs[spring_counter,0] = i</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_spring_counter;
      __pyx_t_2 = 0;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_5 * __pyx_v_springs.strides[0]) )) + __pyx_t_2)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:             springs[spring_counter,1] = adjacent_node_indices[j]</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_spring_counter;
      __pyx_t_5 = 1;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_2 * __pyx_v_springs.strides[0]) )) + __pyx_t_5)) )) = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:             springs[spring_counter,3] = face_spring_length</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_spring_counter;
      __pyx_t_2 = 3;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_5 * __pyx_v_springs.strides[0]) )) + __pyx_t_2)) )) = __pyx_v_face_spring_length;
</pre><pre class="cython line score-0">&#xA0;<span class="">403</span>:             #set spring value</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:             springs[spring_counter,2] = get_face_stiffness(node_type[i], node_type[adjacent_node_indices[j]], k[1])</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = __pyx_v_i;
      __pyx_t_5 = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
      __pyx_t_4 = 1;
      __pyx_t_7 = __pyx_v_spring_counter;
      __pyx_t_6 = 2;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_7 * __pyx_v_springs.strides[0]) )) + __pyx_t_6)) )) = __pyx_f_7springs_get_face_stiffness((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_2, __pyx_pybuffernd_node_type.diminfo[0].strides)), (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_int8_t *, __pyx_pybuffernd_node_type.rcbuffer-&gt;pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_node_type.diminfo[0].strides)), (*((double *) ( /* dim=0 */ (__pyx_v_k.data + __pyx_t_4 * __pyx_v_k.strides[0]) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:             spring_counter += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = (__pyx_v_spring_counter + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:     for j in range(9,13):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 9; __pyx_t_1 &lt; 13; __pyx_t_1+=1) {
    __pyx_v_j = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:         if not disallowed_connections[j]:</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_j;
    __pyx_t_3 = ((!((*__Pyx_BufPtrStrided1d(npy_bool *, __pyx_pybuffernd_disallowed_connections.rcbuffer-&gt;pybuffer.buf, __pyx_t_4, __pyx_pybuffernd_disallowed_connections.diminfo[0].strides)) != 0)) != 0);
    if (__pyx_t_3) {
/* … */
    }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>:             springs[spring_counter,0] = i</pre>
<pre class='cython code score-0 '>      __pyx_t_4 = __pyx_v_spring_counter;
      __pyx_t_5 = 0;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_4 * __pyx_v_springs.strides[0]) )) + __pyx_t_5)) )) = __pyx_v_i;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">409</span>:             springs[spring_counter,1] = adjacent_node_indices[j]</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = __pyx_v_spring_counter;
      __pyx_t_4 = 1;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_5 * __pyx_v_springs.strides[0]) )) + __pyx_t_4)) )) = (__pyx_v_adjacent_node_indices[__pyx_v_j]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:             springs[spring_counter,3] = center_diagonal_length</pre>
<pre class='cython code score-0 '>      __pyx_t_4 = __pyx_v_spring_counter;
      __pyx_t_5 = 3;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_4 * __pyx_v_springs.strides[0]) )) + __pyx_t_5)) )) = __pyx_v_center_diagonal_length;
</pre><pre class="cython line score-0">&#xA0;<span class="">411</span>:             #set spring value</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">412</span>:             springs[spring_counter,2] = k[2]</pre>
<pre class='cython code score-0 '>      __pyx_t_5 = 2;
      __pyx_t_4 = __pyx_v_spring_counter;
      __pyx_t_2 = 2;
      *((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_springs.data + __pyx_t_4 * __pyx_v_springs.strides[0]) )) + __pyx_t_2)) )) = (*((double *) ( /* dim=0 */ (__pyx_v_k.data + __pyx_t_5 * __pyx_v_k.strides[0]) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:             spring_counter += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_spring_counter = (__pyx_v_spring_counter + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>:     return spring_counter</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_spring_counter;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">415</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">416</span>: cdef double get_edge_stiffness(int node_type_i,int node_type_j, double k):</pre>
<pre class='cython code score-0 '>static double __pyx_f_7springs_get_edge_stiffness(int __pyx_v_node_type_i, int __pyx_v_node_type_j, double __pyx_v_k) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_edge_stiffness", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">417</span>:     if node_type_i &gt; 0 and node_type_i &lt; 7:#surface</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_node_type_i &gt; 0) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_node_type_i &lt; 7) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:         if node_type_j == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_node_type_j == 0) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>:             return k</pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_k;
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>:         if node_type_j &gt;0 and node_type_j &lt; 7:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 0) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 7) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>:             if node_type_i == node_type_j:</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_node_type_i == __pyx_v_node_type_j) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">423</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:                 return k</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_r = __pyx_v_k;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">425</span>:         if node_type_j &gt; 6 and node_type_j &lt; 19: #edge</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 6) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 19) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">426</span>:             return k/2</pre>
<pre class='cython code score-0 '>      __pyx_r = (__pyx_v_k / 2.0);
      goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">427</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>:             return k/4</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = (__pyx_v_k / 4.0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">429</span>:     if node_type_i &gt; 6 and node_type_i &lt; 19: #edge</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_node_type_i &gt; 6) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L15_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_node_type_i &lt; 19) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L15_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>:         if node_type_j &gt; 0 and node_type_j &lt; 7:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 0) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L18_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 7) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L18_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">431</span>:             return k/2</pre>
<pre class='cython code score-0 '>      __pyx_r = (__pyx_v_k / 2.0);
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">432</span>:         if node_type_j &gt; 6 and node_type_j &lt; 19:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 6) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 19) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">433</span>:             if node_type_i == node_type_j:</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_node_type_i == __pyx_v_node_type_j) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">434</span>:                 return k/4</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 4.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">435</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">436</span>:                 return k/2</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">437</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">438</span>:             return k/4</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = (__pyx_v_k / 4.0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">439</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">440</span>:         return k/4</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = (__pyx_v_k / 4.0);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">441</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">442</span>: cdef double get_face_stiffness(int node_type_i,int node_type_j, double k):</pre>
<pre class='cython code score-0 '>static double __pyx_f_7springs_get_face_stiffness(int __pyx_v_node_type_i, int __pyx_v_node_type_j, double __pyx_v_k) {
  double __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_face_stiffness", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">443</span>:     if node_type_i &gt; 0 and node_type_i &lt; 7:#surface</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_node_type_i &gt; 0) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_node_type_i &lt; 7) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:         if node_type_j == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_node_type_j == 0) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">445</span>:             return k</pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_k;
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">446</span>:         if node_type_j &gt;0 and node_type_j &lt; 7:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 0) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 7) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">447</span>:             if node_type_i == node_type_j:#same surface</pre>
<pre class='cython code score-0 '>      __pyx_t_1 = ((__pyx_v_node_type_i == __pyx_v_node_type_j) != 0);
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">448</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">449</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>:                 return k</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_r = __pyx_v_k;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:         if node_type_j &gt; 6 and node_type_j &lt; 19: #edge</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 6) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 19) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:             if node_type_i == 1 and (node_type_j == 7 or node_type_j == 8 or node_type_j == 9 or node_type_j == 10):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 1) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L15_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 7:
        case 8:
        case 9:
        case 10:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L15_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:             elif node_type_i == 2 and (node_type_j == 11 or node_type_j == 12 or node_type_j == 13 or node_type_j == 14):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 2) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L17_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 11:
        case 12:
        case 13:
        case 14:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L17_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">456</span>:             elif node_type_i == 3 and (node_type_j == 7 or node_type_j == 11 or node_type_j == 15 or node_type_j == 16):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 3) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L19_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 7:
        case 11:
        case 15:
        case 16:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L19_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:             elif node_type_i == 4 and (node_type_j == 8 or node_type_j == 12 or node_type_j == 17 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 4) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L21_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 8:
        case 12:
        case 17:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L21_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:             elif node_type_i == 5 and (node_type_j == 9 or node_type_j == 13 or node_type_j == 15 or node_type_j == 17):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 5) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L23_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 9:
        case 13:
        case 15:
        case 17:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L23_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:             elif node_type_i == 6 and (node_type_j == 10 or node_type_j == 14 or node_type_j == 16 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 6) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L25_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 10:
        case 14:
        case 16:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L25_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">464</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>:                 return k</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_r = __pyx_v_k;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">466</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:             return k/2</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = (__pyx_v_k / 2.0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:     if node_type_i &gt; 6 and node_type_i &lt; 19: #edge</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_node_type_i &gt; 6) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L28_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_node_type_i &lt; 19) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L28_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:         if node_type_j == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_node_type_j == 0) != 0);
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:             return k</pre>
<pre class='cython code score-0 '>      __pyx_r = __pyx_v_k;
      goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:         if node_type_j &gt; 0 and node_type_j &lt; 7:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 0) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L32_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 7) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L32_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:             if node_type_j == 1 and (node_type_i == 7 or node_type_i == 8 or node_type_i == 9 or node_type_i == 10):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_j == 1) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L35_bool_binop_done;
      }
      switch (__pyx_v_node_type_i) {
        case 7:
        case 8:
        case 9:
        case 10:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L35_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:             elif node_type_j == 2 and (node_type_i == 11 or node_type_i == 12 or node_type_i == 13 or node_type_i == 14):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_j == 2) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L37_bool_binop_done;
      }
      switch (__pyx_v_node_type_i) {
        case 11:
        case 12:
        case 13:
        case 14:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L37_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">475</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:             elif node_type_j == 3 and (node_type_i == 7 or node_type_i == 11 or node_type_i == 15 or node_type_i == 16):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_j == 3) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L39_bool_binop_done;
      }
      switch (__pyx_v_node_type_i) {
        case 7:
        case 11:
        case 15:
        case 16:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L39_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:             elif node_type_j == 4 and (node_type_i == 8 or node_type_i == 12 or node_type_i == 17 or node_type_i == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_j == 4) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L41_bool_binop_done;
      }
      switch (__pyx_v_node_type_i) {
        case 8:
        case 12:
        case 17:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L41_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:             elif node_type_j == 5 and (node_type_i == 9 or node_type_i == 13 or node_type_i == 15 or node_type_i == 17):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_j == 5) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L43_bool_binop_done;
      }
      switch (__pyx_v_node_type_i) {
        case 9:
        case 13:
        case 15:
        case 17:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L43_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">481</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:             elif node_type_j == 6 and (node_type_i == 10 or node_type_i == 14 or node_type_i == 16 or node_type_i == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_j == 6) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L45_bool_binop_done;
      }
      switch (__pyx_v_node_type_i) {
        case 10:
        case 14:
        case 16:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L45_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">484</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:                 return k</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_r = __pyx_v_k;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:         if node_type_j &gt; 6 and node_type_j &lt; 19:</pre>
<pre class='cython code score-0 '>    __pyx_t_2 = ((__pyx_v_node_type_j &gt; 6) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L48_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_node_type_j &lt; 19) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L48_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">487</span>:             #if they don't share a single surface, then they diagonally across one another and have two shared elements, so we return k. if they do share a surface, they have on shared element, and we return k/2</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:             if node_type_i == 7 and (node_type_j == 8 or node_type_j == 9 or node_type_j == 10 or node_type_j == 11 or node_type_j == 15 or node_type_j == 16):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 7) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L51_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 8:
        case 9:
        case 10:
        case 11:
        case 15:
        case 16:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L51_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:             elif node_type_i == 8 and (node_type_j == 7 or node_type_j == 9 or node_type_j == 10 or node_type_j == 12 or node_type_j == 17 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 8) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L53_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 7:
        case 9:
        case 10:
        case 12:
        case 17:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L53_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:             elif node_type_i == 9 and (node_type_j == 7 or node_type_j == 8 or node_type_j == 10 or node_type_j == 13 or node_type_j == 15 or node_type_j == 17):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 9) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L55_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 7:
        case 8:
        case 10:
        case 13:
        case 15:
        case 17:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L55_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:             elif node_type_i == 10 and (node_type_j == 7 or node_type_j == 8 or node_type_j == 9 or node_type_j == 14 or node_type_j == 16 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 10) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L57_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 7:
        case 8:
        case 9:
        case 14:
        case 16:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L57_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">495</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">496</span>:             elif node_type_i == 11 and (node_type_j == 12 or node_type_j == 13 or node_type_j == 14 or node_type_j == 7 or node_type_j == 15 or node_type_j == 16):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 11) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L59_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 12:
        case 13:
        case 14:
        case 7:
        case 15:
        case 16:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L59_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">498</span>:             elif node_type_i == 12 and (node_type_j == 11 or node_type_j == 13 or node_type_j == 14 or node_type_j == 8 or node_type_j == 17 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 12) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L61_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 11:
        case 13:
        case 14:
        case 8:
        case 17:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L61_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">499</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:             elif node_type_i == 13 and (node_type_j == 11 or node_type_j == 12 or node_type_j == 14 or node_type_j == 9 or node_type_j == 15 or node_type_j == 17):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 13) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L63_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 11:
        case 12:
        case 14:
        case 9:
        case 15:
        case 17:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L63_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">502</span>:             elif node_type_i == 14 and (node_type_j == 11 or node_type_j == 12 or node_type_j == 13 or node_type_j == 10 or node_type_j == 16 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 14) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L65_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 11:
        case 12:
        case 13:
        case 10:
        case 16:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L65_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>:             elif node_type_i == 15 and (node_type_j == 16 or node_type_j == 7 or node_type_j == 11 or node_type_j == 9 or node_type_j == 13 or node_type_j == 17):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 15) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L67_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 16:
        case 7:
        case 11:
        case 9:
        case 13:
        case 17:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L67_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">505</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:             elif node_type_i == 16 and (node_type_j == 15 or node_type_j == 7 or node_type_j == 11 or node_type_j == 10 or node_type_j == 14 or node_type_j == 18):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 16) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L69_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 15:
        case 7:
        case 11:
        case 10:
        case 14:
        case 18:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L69_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">508</span>:             elif node_type_i == 17 and (node_type_j == 18 or node_type_j == 8 or node_type_j == 12 or node_type_j == 9 or node_type_j == 13 or node_type_j == 15):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 17) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L71_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 18:
        case 8:
        case 12:
        case 9:
        case 13:
        case 15:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L71_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:             elif node_type_i == 18 and (node_type_j == 17 or node_type_j == 8 or node_type_j == 12 or node_type_j == 10 or node_type_j == 14 or node_type_j == 16):</pre>
<pre class='cython code score-0 '>      __pyx_t_2 = ((__pyx_v_node_type_i == 18) != 0);
      if (__pyx_t_2) {
      } else {
        __pyx_t_1 = __pyx_t_2;
        goto __pyx_L73_bool_binop_done;
      }
      switch (__pyx_v_node_type_j) {
        case 17:
        case 8:
        case 12:
        case 10:
        case 14:
        case 16:
        __pyx_t_2 = 1;
        break;
        default:
        __pyx_t_2 = 0;
        break;
      }
      __pyx_t_1 = __pyx_t_2;
      __pyx_L73_bool_binop_done:;
      if (__pyx_t_1) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">511</span>:                 return k/2</pre>
<pre class='cython code score-0 '>        __pyx_r = (__pyx_v_k / 2.0);
        goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">512</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:                 return k</pre>
<pre class='cython code score-0 '>      /*else*/ {
        __pyx_r = __pyx_v_k;
        goto __pyx_L0;
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">514</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>:             return k/2</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_r = (__pyx_v_k / 2.0);
      goto __pyx_L0;
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">516</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">517</span>:         return k/2</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = (__pyx_v_k / 2.0);
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">518</span>:     #surface type that shares a surface with edge types</pre>
<pre class="cython line score-0">&#xA0;<span class="">519</span>:     # 1,, 7,8,9,10</pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>:     # 2,, 11,12,13,14</pre>
<pre class="cython line score-0">&#xA0;<span class="">521</span>:     # 3,, 7,11,15,16</pre>
<pre class="cython line score-0">&#xA0;<span class="">522</span>:     # 4,, 8,12,17,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">523</span>:     # 5,, 9,13,15,17</pre>
<pre class="cython line score-0">&#xA0;<span class="">524</span>:     # 6,, 10,14,16,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">525</span>:     #edge types that share a surface with edge types</pre>
<pre class="cython line score-0">&#xA0;<span class="">526</span>:     # 7,, 8,9,10,11,15,16</pre>
<pre class="cython line score-0">&#xA0;<span class="">527</span>:     # 8,, 7,9,10,12,17,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">528</span>:     # 9,, 7,8,10,13,15,17</pre>
<pre class="cython line score-0">&#xA0;<span class="">529</span>:     # 10,, 7,8,9,14,16,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">530</span>:     # 11,, 12,13,14,7,15,16</pre>
<pre class="cython line score-0">&#xA0;<span class="">531</span>:     # 12,, 11,13,14,8,17,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">532</span>:     # 13,, 11,12,14,9,15,17</pre>
<pre class="cython line score-0">&#xA0;<span class="">533</span>:     # 14,, 11,12,13,10,16,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>:     # 15,, 16,7,11,9,13,17</pre>
<pre class="cython line score-0">&#xA0;<span class="">535</span>:     # 16,, 15,7,11,10,14,18</pre>
<pre class="cython line score-0">&#xA0;<span class="">536</span>:     # 17,, 18,8,12,9,13,15</pre>
<pre class="cython line score-0">&#xA0;<span class="">537</span>:     # 18,, 17,8,12,10,14,16</pre>
</div></body></html>
